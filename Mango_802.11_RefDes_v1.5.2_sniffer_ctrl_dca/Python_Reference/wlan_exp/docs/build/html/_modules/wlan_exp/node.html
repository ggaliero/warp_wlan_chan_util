

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>wlan_exp.node &mdash; mango_wlan_exp wlan_exp v1.5.2   documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/rtd_overrides.css" type="text/css" />
  

  
    <link rel="top" title="mango_wlan_exp wlan_exp v1.5.2   documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> mango_wlan_exp</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../wlan_exp.html">Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../node.html">Node Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wlan_exp_util.html">WLAN Exp Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ltg.html">LTG Flow Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../device.html">WLAN Device</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../wlan_exp_log.html">Event Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../log_overview.html">Event Log Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../log_entry_types.html">Log Entry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../log_util.html">Event Log Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../log_util_hdf.html">HDF5 Utilities</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">mango_wlan_exp</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>wlan_exp.node</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for wlan_exp.node</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">------------------------------------------------------------------------------</span>
<span class="sd">Mango 802.11 Reference Design Experiments Framework - Node Classes</span>
<span class="sd">------------------------------------------------------------------------------</span>
<span class="sd">Authors:   Chris Hunter (chunter [at] mangocomm.com)</span>
<span class="sd">           Patrick Murphy (murphpo [at] mangocomm.com)</span>
<span class="sd">           Erik Welsh (welsh [at] mangocomm.com)</span>
<span class="sd">License:   Copyright 2014-2016, Mango Communications. All rights reserved.</span>
<span class="sd">           Distributed under the WARP license (http://warpproject.org/license)</span>
<span class="sd">------------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">wlan_exp.transport.node</span> <span class="kn">as</span> <span class="nn">node</span>
<span class="kn">import</span> <span class="nn">wlan_exp.transport.exception</span> <span class="kn">as</span> <span class="nn">ex</span>

<span class="kn">import</span> <span class="nn">wlan_exp.version</span> <span class="kn">as</span> <span class="nn">version</span>
<span class="kn">import</span> <span class="nn">wlan_exp.defaults</span> <span class="kn">as</span> <span class="nn">defaults</span>
<span class="kn">import</span> <span class="nn">wlan_exp.cmds</span> <span class="kn">as</span> <span class="nn">cmds</span>
<span class="kn">import</span> <span class="nn">wlan_exp.device</span> <span class="kn">as</span> <span class="nn">wlan_device</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;WlanExpNode&#39;</span><span class="p">,</span> <span class="s">&#39;WlanExpNodeFactory&#39;</span><span class="p">]</span>

<span class="c"># Fix to support Python 2.x and 3.x</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="nb">long</span><span class="o">=</span><span class="bp">None</span>

<span class="c"># Node Parameter Identifiers</span>
<span class="c">#   Values here must match the C counterparts in *_node.h</span>
<span class="c">#</span>
<span class="c"># If additional hardware parameters are needed for sub-classes of WlanExpNode,</span>
<span class="c"># please make sure that the values of these hardware parameters are not reused.</span>
<span class="c">#</span>
<span class="n">NODE_PARAM_ID_WLAN_EXP_VERSION</span>                  <span class="o">=</span> <span class="mi">5</span>
<span class="n">NODE_PARAM_ID_WLAN_SCHEDULER_RESOLUTION</span>         <span class="o">=</span> <span class="mi">6</span>
<span class="n">NODE_PARAM_ID_WLAN_MAC_ADDR</span>                     <span class="o">=</span> <span class="mi">7</span>
<span class="n">NODE_PARAM_ID_WLAN_MAX_TX_POWER_DBM</span>             <span class="o">=</span> <span class="mi">8</span>
<span class="n">NODE_PARAM_ID_WLAN_MIN_TX_POWER_DBM</span>             <span class="o">=</span> <span class="mi">9</span>


<div class="viewcode-block" id="WlanExpNode"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode">[docs]</a><span class="k">class</span> <span class="nc">WlanExpNode</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">WarpNode</span><span class="p">,</span> <span class="n">wlan_device</span><span class="o">.</span><span class="n">WlanDevice</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for 802.11 Reference Design Experiments Framwork node.</span>

<span class="sd">    Args:</span>
<span class="sd">        network_config (transport.NetworkConfiguration) : Network configuration of the node</span>


<span class="sd">    Attributes:</span>
<span class="sd">        node_type (int): Unique type of the node</span>
<span class="sd">        node_id (int): Unique identification for this node</span>
<span class="sd">        name (str): User specified name for this node (supplied by user scripts)</span>
<span class="sd">        description (str): String description of this node (auto-generated)</span>
<span class="sd">        serial_number (int): Node&#39;s serial number, read from EEPROM on hardware</span>
<span class="sd">        fpga_dna (int): Node&#39;s FPGA&#39;a unique identification (on select hardware)</span>
<span class="sd">        hw_ver (int): WARP hardware version of this node</span>
<span class="sd">        transport (transport.Transport): Node&#39;s transport object</span>
<span class="sd">        transport_broadcast (transport.Transport): Node&#39;s broadcast transport object</span>

<span class="sd">        device_type (int): Unique type of the ``WlanDevice`` (inherited from ``WlanDevice``)</span>
<span class="sd">        wlan_mac_address (int): Wireless MAC address of the node (inherited from ``WlanDevice``)</span>
<span class="sd">        ht_capable (bool): Indicates if device has PHY capable of HT (802.11n) rates </span>
<span class="sd">            (inherited from ``WlanDevice``)</span>

<span class="sd">        scheduler_resolution (int): Minimum resolution (in us) of the scheduler.  This</span>
<span class="sd">            is also the minimum time between LTGs.</span>
<span class="sd">        log_max_size (int): Maximum size of event log (in bytes)</span>
<span class="sd">        log_total_bytes_read (int): Number of bytes read from the event log</span>
<span class="sd">        log_num_wraps (int): Number of times the event log has wrapped</span>
<span class="sd">        log_next_read_index (int): Index in to event log of next read</span>
<span class="sd">        wlan_exp_ver_major (int): ``wlan_exp`` Major version running on this node</span>
<span class="sd">        wlan_exp_ver_minor (int): ``wlan_exp`` Minor version running on this node</span>
<span class="sd">        wlan_exp_ver_revision (int): ``wlan_exp`` Revision version running on this node</span>
<span class="sd">        max_tx_power_dbm(int): Maximum transmit power of the node (in dBm)</span>
<span class="sd">        min_tx_power_dbm(int): Minimum transmit power of the node (in dBm)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scheduler_resolution</span>               <span class="o">=</span> <span class="bp">None</span>

    <span class="n">log_max_size</span>                       <span class="o">=</span> <span class="bp">None</span>
    <span class="n">log_total_bytes_read</span>               <span class="o">=</span> <span class="bp">None</span>
    <span class="n">log_num_wraps</span>                      <span class="o">=</span> <span class="bp">None</span>
    <span class="n">log_next_read_index</span>                <span class="o">=</span> <span class="bp">None</span>

    <span class="n">wlan_exp_ver_major</span>                 <span class="o">=</span> <span class="bp">None</span>
    <span class="n">wlan_exp_ver_minor</span>                 <span class="o">=</span> <span class="bp">None</span>
    <span class="n">wlan_exp_ver_revision</span>              <span class="o">=</span> <span class="bp">None</span>

    <span class="n">max_tx_power_dbm</span>                   <span class="o">=</span> <span class="bp">None</span>
    <span class="n">min_tx_power_dbm</span>                   <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_config</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WlanExpNode</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">network_config</span><span class="p">)</span>

        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_major</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_minor</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_revision</span><span class="p">)</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">wlan_exp_ver</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_resolution</span>           <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log_total_bytes_read</span>           <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span>                  <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span>            <span class="o">=</span> <span class="mi">0</span>

        <span class="c"># As of v1.5 all 802.11 Ref Design nodes are HT capable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ht_capable</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c">#-------------------------------------------------------------------------</span>
    <span class="c"># Node Commands</span>
    <span class="c">#-------------------------------------------------------------------------</span>


    <span class="c">#--------------------------------------------</span>
    <span class="c"># Log Commands</span>
    <span class="c">#--------------------------------------------</span>
<div class="viewcode-block" id="WlanExpNode.log_configure"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_configure">[docs]</a>    <span class="k">def</span> <span class="nf">log_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_enable</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log_wrap_enable</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                            <span class="n">log_full_payloads</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log_txrx_mpdu</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  
                            <span class="n">log_txrx_ctrl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure log with the given flags.</span>

<span class="sd">        By default all attributes are set to None.  Only attributes that</span>
<span class="sd">        are given values will be updated on the node.  If an attribute is</span>
<span class="sd">        not specified, then that attribute will retain the same value on</span>
<span class="sd">        the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            log_enable (bool):        Enable the event log </span>
<span class="sd">                (Default value on Node: TRUE)</span>
<span class="sd">            log_wrap_enable (bool):   Enable event log wrapping </span>
<span class="sd">                (Default value on Node: FALSE)</span>
<span class="sd">            log_full_payloads (bool): Record full Tx/Rx payloads in event log </span>
<span class="sd">                (Default value on Node: FALSE)</span>
<span class="sd">            log_txrx_mpdu (bool):     Enable Tx/Rx log entries for MPDU frames</span>
<span class="sd">                (Default value on Node: TRUE)</span>
<span class="sd">            log_txrx_ctrl (bool):     Enable Tx/Rx log entries for CTRL frames</span>
<span class="sd">                (Default value on Node: TRUE)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogConfigure</span><span class="p">(</span><span class="n">log_enable</span><span class="p">,</span> <span class="n">log_wrap_enable</span><span class="p">,</span>
                                        <span class="n">log_full_payloads</span><span class="p">,</span> <span class="n">log_txrx_mpdu</span><span class="p">,</span> 
                                        <span class="n">log_txrx_ctrl</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get">[docs]</a>    <span class="k">def</span> <span class="nf">log_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_req_size</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">23</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Low level method to retrieve log data from a wlan_exp node.</span>

<span class="sd">        Args:</span>
<span class="sd">            size (int):                   Number of bytes to read from the log</span>
<span class="sd">            offset (int, optional):       Starting byte to read from the log</span>
<span class="sd">            max_req_size (int, optional): Max request size that the transport </span>
<span class="sd">                will fragment the request into.</span>

<span class="sd">        Returns:</span>
<span class="sd">            buffer (transport.Buffer):  </span>
<span class="sd">                Data from the log corresponding to the input parameters</span>

<span class="sd">        There is no guarentee that this will return data aligned to event</span>
<span class="sd">        boundaries.  Use ``log_get_indexes()`` to get event aligned boundaries.</span>

<span class="sd">        Log reads are not destructive. Log entries will only be destroyed by a </span>
<span class="sd">        log reset or if the log wraps.</span>

<span class="sd">        During a given ``log_get()`` command, the ETH_B Ethernet interface of</span>
<span class="sd">        the node will not be able to respond to any other Ethernet packets</span>
<span class="sd">        that are sent to the node.  This could cause the node to drop</span>
<span class="sd">        incoming wlan_exp packets from other wlan_exp instances accessing</span>
<span class="sd">        the node. Therefore, for large requests, having a smaller </span>
<span class="sd">        ``max_req_size`` will allow the transport to fragement the command and </span>
<span class="sd">        allow the node to be responsive to multiple hosts.</span>

<span class="sd">        Some basic analysis shows that fragment sizes of 2**23 (8 MB)</span>
<span class="sd">        add about 2% overhead to the receive time and each command takes less</span>
<span class="sd">        than 1 second (~0.9 sec), which is the default transport timeout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmd_size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">log_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get_size</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">((</span><span class="n">size</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">log_size</span><span class="p">):</span>
            <span class="n">cmd_size</span> <span class="o">=</span> <span class="n">log_size</span> <span class="o">-</span> <span class="n">offset</span>

            <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  Trying to get {0} bytes from the log at offset {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;    while log only has {0} bytes.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">log_size</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;    Truncating command to {0} bytes at offset {1}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmd_size</span><span class="p">,</span> <span class="n">offset</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogGetEvents</span><span class="p">(</span><span class="n">cmd_size</span><span class="p">,</span> <span class="n">offset</span><span class="p">),</span> <span class="n">max_req_size</span><span class="o">=</span><span class="n">max_req_size</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get_all_new"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get_all_new">[docs]</a>    <span class="k">def</span> <span class="nf">log_get_all_new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_tail_pad</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_req_size</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">23</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get all &quot;new&quot; entries in the log.</span>
<span class="sd">        </span>
<span class="sd">        In order to make reading log data easier, the ``log_get_all_new()``</span>
<span class="sd">        command was created.  It utilizes the ``log_get_indexex()`` and </span>
<span class="sd">        ``log_get()`` commmands to understand the state of the log and to </span>
<span class="sd">        retrieve data from the log.  The Python node object also maintains </span>
<span class="sd">        internal state about what log data has been read from the node to </span>
<span class="sd">        determine if there is &quot;new&quot; data in the log.  Since this state data is </span>
<span class="sd">        maintained in Python and not on the node itself, it is possible for</span>
<span class="sd">        multiple host scripts to read log data using ``log_get_all_new()``. The </span>
<span class="sd">        internal state maintained for ``log_get_all_new()`` is only reset when </span>
<span class="sd">        using the node reset method (i.e. ``node.reset(log=True)``).</span>
<span class="sd">        </span>
<span class="sd">        When a node is adding entries to its log, it will allocate the </span>
<span class="sd">        memory for an entry from the log and then fill in the contents.  This </span>
<span class="sd">        means at any given time, the last log entry may have incomplete </span>
<span class="sd">        information.  Currently, the log maintains the index where the next </span>
<span class="sd">        log entry will be recorded (i.e. the ``next_index``), which does not </span>
<span class="sd">        provide any state about whether the last log entry has been completed.</span>
<span class="sd">        Therefore, in order to not retrieve incomplete information, </span>
<span class="sd">        ``log_get_all_new()`` has an argument ``log_tail_pad=N`` to not read </span>
<span class="sd">        the last N &quot;new&quot; bytes of log data.  </span>
<span class="sd">        </span>
<span class="sd">        Unfortunately, this means that using a ``log_tail_pad`` other than </span>
<span class="sd">        zero will result in return data that is not aligned to a log entry</span>
<span class="sd">        boundary.  This should not be an issue if the goal is to periodically</span>
<span class="sd">        read the log data from the node and store it in a file (as seen in </span>
<span class="sd">        the ``log_capture_continuous.py`` example).  However, this can be an </span>
<span class="sd">        issue if trying to periodically read the log and process the log data </span>
<span class="sd">        directly.  In this case, ``log_tail_pad`` must be zero and the code </span>
<span class="sd">        has to assume the last entry is invalid.  This has not come up very </span>
<span class="sd">        much, but please let us know if this is an issue via the forums.        </span>

<span class="sd">        Args:</span>
<span class="sd">            log_tail_pad (int, optional): Number of bytes from the current end </span>
<span class="sd">                of the &quot;new&quot; entries that will not be read during the call.  </span>
<span class="sd">                This is to deal with the case where the node is in the process </span>
<span class="sd">                of modifying the last log entry so it my contain incomplete </span>
<span class="sd">                data and should not be read.</span>

<span class="sd">        Returns:</span>
<span class="sd">            buffer (transport.Buffer): </span>
<span class="sd">                Data from the log that contains all entries since the last </span>
<span class="sd">                time the log was read.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.transport.message</span> <span class="kn">as</span> <span class="nn">message</span>

        <span class="n">return_val</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">Buffer</span><span class="p">()</span>

        <span class="c"># Check if the log is full to interpret the indexes correctly</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_is_full</span><span class="p">()):</span>
            <span class="n">log_size</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get_size</span><span class="p">()</span>
            <span class="n">read_size</span> <span class="o">=</span> <span class="n">log_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">-</span> <span class="n">log_tail_pad</span>

            <span class="c"># Read the data from the node</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">read_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span><span class="p">,</span>
                                          <span class="n">size</span><span class="o">=</span><span class="n">read_size</span><span class="p">,</span>
                                          <span class="n">max_req_size</span><span class="o">=</span><span class="n">max_req_size</span><span class="p">)</span>

                <span class="c"># Only increment index by how much was actually read</span>
                <span class="n">read_size</span>  <span class="o">=</span> <span class="n">return_val</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">()</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">read_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">+=</span> <span class="n">read_size</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  Not able to read data from node.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  No new data on node.&quot;</span><span class="p">)</span>

        <span class="c"># Log is not full</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">next_index</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">num_wraps</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get_indexes</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="c"># This is the first read of the log by this python object</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">num_wraps</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="c"># Need to advance the num_wraps to the current num_wraps so</span>
                    <span class="c"># that the code does not get into a bad state with log reading.</span>
                    <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">WARNING:  On first read, the log on the node has already wrapped.</span><span class="se">\n</span><span class="s">&quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Skipping the first {0} wraps of log data.</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_wraps</span><span class="p">)</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span> <span class="o">=</span> <span class="n">num_wraps</span>

            <span class="c"># Check if log has wrapped</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">num_wraps</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span><span class="p">):</span>
                <span class="c"># Since log has not wrapped, then read to the (next_index - log_tail_pad)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">next_index</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">+</span> <span class="n">log_tail_pad</span><span class="p">)):</span>

                    <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span><span class="p">,</span>
                                              <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">next_index</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">-</span> <span class="n">log_tail_pad</span><span class="p">),</span>
                                              <span class="n">max_req_size</span><span class="o">=</span><span class="n">max_req_size</span><span class="p">)</span>

                    <span class="c"># Only increment index by how much was actually read</span>
                    <span class="n">read_size</span>  <span class="o">=</span> <span class="n">return_val</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">read_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">+=</span> <span class="n">read_size</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  Not able to read data from node.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  No new data on node.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Log has wrapped.  Get all the entries on the old wrap</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">next_index</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>

                    <span class="n">return_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_get</span><span class="p">(</span><span class="n">offset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span><span class="p">,</span>
                                              <span class="n">size</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOG_GET_ALL_ENTRIES</span><span class="p">,</span>
                                              <span class="n">max_req_size</span><span class="o">=</span><span class="n">max_req_size</span><span class="p">)</span>

                    <span class="c"># The amount of data returned from the node should not be zero</span>
                    <span class="n">read_size</span>  <span class="o">=</span> <span class="n">return_val</span><span class="o">.</span><span class="n">get_buffer_size</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">read_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span>       <span class="o">=</span> <span class="n">num_wraps</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  Not able to read data from node.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING:  No new data on node.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">return_val</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get_size"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get_size">[docs]</a>    <span class="k">def</span> <span class="nf">log_get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the size of the node&#39;s current log (in bytes).</span>

<span class="sd">        Returns:</span>
<span class="sd">            num_bytes (int): Number of bytes in the log</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogGetCapacity</span><span class="p">())</span>

        <span class="c"># Check the maximum size of the log and update the node state</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span> <span class="o">!=</span> <span class="n">capacity</span><span class="p">):</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;EVENT LOG WARNING:  Log capacity changed.</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Went from {0} bytes to &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;{0} bytes.</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">capacity</span><span class="p">)</span>
                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span> <span class="o">=</span> <span class="n">capacity</span>

        <span class="k">return</span> <span class="n">size</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get_capacity"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get_capacity">[docs]</a>    <span class="k">def</span> <span class="nf">log_get_capacity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the total capacity of the node&#39;s log memory allocation (in bytes).</span>

<span class="sd">        Returns:</span>
<span class="sd">            capacity (int): Number of byte allocated for the log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_max_size</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get_indexes"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get_indexes">[docs]</a>    <span class="k">def</span> <span class="nf">log_get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the indexes that describe the state of the event log.</span>

<span class="sd">        Returns:</span>
<span class="sd">            indexes (tuple):</span>
<span class="sd">            </span>
<span class="sd">                #. oldest_index (int): Log index of the oldest event in the log</span>
<span class="sd">                #. next_index (int):   Log index where the next event will be recorded</span>
<span class="sd">                #. num_wraps (int):    Number of times the log has wrapped</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">next_index</span><span class="p">,</span> <span class="n">oldest_index</span><span class="p">,</span> <span class="n">num_wraps</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogGetStatus</span><span class="p">())</span>

        <span class="c"># Check that the log is in a good state</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">num_wraps</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">((</span><span class="n">num_wraps</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span><span class="p">)</span> <span class="ow">and</span>
             <span class="p">(</span><span class="n">next_index</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span><span class="p">))):</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">!!! Event Log Corrupted.  Please reset the log. !!!</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">next_index</span><span class="p">,</span> <span class="n">oldest_index</span><span class="p">,</span> <span class="n">num_wraps</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_get_flags"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_get_flags">[docs]</a>    <span class="k">def</span> <span class="nf">log_get_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the flags that describe the event log configuration.</span>

<span class="sd">        Returns:</span>
<span class="sd">            flags (int): Integer describing the configuration of the event log.</span>
<span class="sd">            </span>
<span class="sd">                * ``0x0001`` - Logging enabled</span>
<span class="sd">                * ``0x0002`` - Log wrapping enabled</span>
<span class="sd">                * ``0x0004`` - Full payload logging enabled</span>
<span class="sd">                * ``0x0008`` - Tx/Rx log entries for MPDU frames enabled</span>
<span class="sd">                * ``0x0010`` - Tx/Rx log entries for CTRL frames enabled</span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogGetStatus</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">flags</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_is_full"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_is_full">[docs]</a>    <span class="k">def</span> <span class="nf">log_is_full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return whether the log is full or not.</span>

<span class="sd">        Returns:</span>
<span class="sd">            status (bool): True if the log is full; False if the log is not full.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">(</span><span class="n">next_index</span><span class="p">,</span> <span class="n">oldest_index</span><span class="p">,</span> <span class="n">num_wraps</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogGetStatus</span><span class="p">())</span>

        <span class="k">if</span> <span class="p">(((</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOG_CONFIG_FLAG_WRAP</span><span class="p">)</span> <span class="o">!=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOG_CONFIG_FLAG_WRAP</span><span class="p">)</span> <span class="ow">and</span>
            <span class="p">((</span><span class="n">next_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">oldest_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">num_wraps</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))):</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_write_exp_info"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_write_exp_info">[docs]</a>    <span class="k">def</span> <span class="nf">log_write_exp_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info_type</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the experiment information provided to the log.</span>

<span class="sd">        Args:</span>
<span class="sd">            info_type (int): Type of the experiment info.  This is an arbitrary </span>
<span class="sd">                16 bit number chosen by the experimentor</span>
<span class="sd">            message (int, str, bytes, optional): Information to be placed in </span>
<span class="sd">                the event log.</span>

<span class="sd">        Message must be able to be converted to bytearray with &#39;UTF-8&#39; format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LogAddExpInfoEntry</span><span class="p">(</span><span class="n">info_type</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.log_write_time"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.log_write_time">[docs]</a>    <span class="k">def</span> <span class="nf">log_write_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds the current time in microseconds to the log.</span>

<span class="sd">        Args:</span>
<span class="sd">            time_id (int, optional):  User providied identifier to be used for </span>
<span class="sd">                the TIME_INFO log entry.  If none is provided, a random number </span>
<span class="sd">                will be inserted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTime</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_TIME_ADD_TO_LOG</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_RSVD_TIME</span><span class="p">,</span> <span class="n">time_id</span><span class="p">))</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Counts Commands</span>
    <span class="c">#--------------------------------------------</span></div>
    <span class="k">def</span> <span class="nf">counts_get_txrx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;DEPRECATED: Old name for current get_txrx_counts method</span>
<span class="sd">        &quot;&quot;&quot;</span>       
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;WARNING: the counts_get_txrx() method has been renamed get_txrx_counts!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; The old method will be removed in a future release. Please update your script</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot; to use get_txrx_counts</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_txrx_counts</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="WlanExpNode.get_txrx_counts"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_txrx_counts">[docs]</a>    <span class="k">def</span> <span class="nf">get_txrx_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">return_zeroed_counts_if_none</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the Tx/Rx counts data structurs from the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            device_list (list of WlanExpNode, WlanExpNode, WlanDevice, optional): </span>
<span class="sd">                List of devices for which to get counts.  See note below for </span>
<span class="sd">                more information.</span>
<span class="sd">            return_zeroed_counts_if_none(bool, optional):  If no counts exist </span>
<span class="sd">                on the node for the specified device(s), return a zeroed counts </span>
<span class="sd">                dictionary with proper timestamps instead of None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            counts_dictionary (list of TxRxCounts, TxRxCounts): </span>
<span class="sd">                TxRxCounts() for the device(s) specified.</span>


<span class="sd">        The TxRxCounts() structure returned by this method can be accessed like</span>
<span class="sd">        a dictionary and has the following fields:</span>
<span class="sd">        </span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | Field                       | Description                                                                                         |</span>
<span class="sd">            +=============================+=====================================================================================================+</span>
<span class="sd">            | retrieval_timestamp         |  Value of System Time in microseconds when structure retrieved from the node                        |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mac_addr                    |  MAC address of remote node whose statics are recorded here                                         |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_rx_bytes           |  Total number of bytes received in DATA packets from remote node (only non-duplicates)              |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_rx_bytes_total     |  Total number of bytes received in DATA packets from remote node (including duplicates)             |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_tx_bytes_success   |  Total number of bytes successfully transmitted in DATA packets to remote node                      |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_tx_bytes_total     |  Total number of bytes transmitted (successfully or not) in DATA packets to remote node             |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_rx_packets         |  Total number of DATA packets received from remote node                                             |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_tx_packets_success |  Total number of DATA packets successfully transmitted to remote node                               |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_tx_packets_total   |  Total number of DATA packets transmitted (successfully or not) to remote node                      |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | data_num_tx_attempts        |  Total number of low-level attempts of DATA packets to remote node (includes re-transmissions)      |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_rx_bytes           |  Total number of bytes received in management packets from remote node (only non-duplicates)        |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_rx_bytes_total     |  Total number of bytes received in management packets from remote node (including duplicates)       |            </span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_tx_bytes_success   |  Total number of bytes successfully transmitted in management packets to remote node                |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_tx_bytes_total     |  Total number of bytes transmitted (successfully or not) in management packets to remote node       |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_rx_packets         |  Total number of management packets received from remote node (only non-duplicates)                 |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_rx_packets_total   |  Total number of management packets received from remote node (including duplicates)                |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_tx_packets_success |  Total number of management packets successfully transmitted to remote node                         |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_tx_packets_total   |  Total number of management packets transmitted (successfully or not) to remote node                |</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | mgmt_num_tx_attempts        |  Total number of low-level attempts of management packets to remote node (includes re-transmissions)|</span>
<span class="sd">            +-----------------------------+-----------------------------------------------------------------------------------------------------+</span>


<span class="sd">        If the ``device_list`` is a single device, then a single dictionary or </span>
<span class="sd">        None is returned.  If the ``device_list`` is a list of devices, then a</span>
<span class="sd">        list of dictionaries will be returned in the same order as the devices </span>
<span class="sd">        in the list.  If any of the counts are not there, None will be inserted </span>
<span class="sd">        in the list.  If the ``device_list`` is not specified, then all the </span>
<span class="sd">        counts on the node will be returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">device_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">device_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">device_list</span><span class="p">:</span>
                    <span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CountsGetTxRx</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">return_zeroed_counts_if_none</span><span class="p">))</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CountsGetTxRx</span><span class="p">(</span><span class="n">device_list</span><span class="p">,</span> <span class="n">return_zeroed_counts_if_none</span><span class="p">))</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">ret_val</span> <span class="o">=</span> <span class="n">ret_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CountsGetTxRx</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">ret_val</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Local Traffic Generation (LTG) Commands</span>
    <span class="c">#--------------------------------------------</span></div>
<div class="viewcode-block" id="WlanExpNode.ltg_configure"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_configure">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_configure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">traffic_flow</span><span class="p">,</span> <span class="n">auto_start</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure the node for the given traffic flow.</span>

<span class="sd">        Args:</span>
<span class="sd">            traffic_flow (ltg.FlowConfig):  FlowConfig (or subclass of </span>
<span class="sd">                FlowConfig) that describes the parameters of the LTG.</span>
<span class="sd">            auto_start (bool, optional): Automatically start the LTG or wait </span>
<span class="sd">                until it is explictly started.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ID (int):  Identifier for the LTG flow</span>

<span class="sd">        The ``trafic_flow`` argument configures the behavior of the LTG, </span>
<span class="sd">        including the traffic&#39;s destination, packet payloads, and packet </span>
<span class="sd">        generation timing. The reference code implements three flow </span>
<span class="sd">        configurations by default:</span>

<span class="sd">         - ``FlowConfigCBR()``: a constant bit rate (CBR) source targeted to a </span>
<span class="sd">           specifc destination address. Packet lengths and the packet </span>
<span class="sd">           creation interval are constant.</span>
<span class="sd">         - ``FlowConfigAllAssocCBR()``: a CBR source that targets traffic to </span>
<span class="sd">           all nodes in the station info list.</span>
<span class="sd">         - ``FlowConfigRandomRandom()``: a source that targets traffic to a </span>
<span class="sd">           specific destination address, where each packet has a random </span>
<span class="sd">           length and packets are created at random intervals.</span>

<span class="sd">        Refer to the :doc:`ltg` documentation for details on these flow configs </span>
<span class="sd">        and the underlying classes that can be used to build custom flow </span>
<span class="sd">        configurations.</span>

<span class="sd">        Examples:</span>
<span class="sd">            The code below illustrates a few LTG configuration examples. ``n1``</span>
<span class="sd">            and ``n2`` here are a wlan_exp node objects and the LTG traffic in</span>
<span class="sd">            each flow will go from ``n1`` to ``n2``.</span>
<span class="sd">            ::</span>

<span class="sd">                import wlan_exp.ltg as ltg</span>
<span class="sd">                </span>
<span class="sd">                # Configure a CBR LTG addressed to a single node</span>
<span class="sd">                ltg_id = n1.ltg_configure(ltg.FlowConfigCBR(dest_addr=n2.wlan_mac_address, payload_length=40, interval=0.01), auto_start=True)</span>

<span class="sd">                # Configure a backlogged traffic source with constant packet size</span>
<span class="sd">                ltg_id = n1.ltg_configure(ltg.FlowConfigCBR(dest_addr=n2.wlan_mac_address, payload_length=1000, interval=0), auto_start=True)</span>

<span class="sd">                # Configure a random traffic source</span>
<span class="sd">                ltg_id = n1.ltg_configure(ltg.FlowConfigRandomRandom(dest_addr=n2.wlan_mac_address,</span>
<span class="sd">                                               min_payload_length=100,</span>
<span class="sd">                                               max_payload_length=500,</span>
<span class="sd">                                               min_interval=0,</span>
<span class="sd">                                               max_interval=0.1),</span>
<span class="sd">                                            auto_start=True)</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">traffic_flow</span><span class="o">.</span><span class="n">enforce_min_resolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scheduler_resolution</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGConfigure</span><span class="p">(</span><span class="n">traffic_flow</span><span class="p">,</span> <span class="n">auto_start</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_get_status"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_get_status">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ltg_id_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the status of the LTG flows.</span>

<span class="sd">        Args:</span>
<span class="sd">            ltg_id_list (list of int, int): List of LTG flow identifiers or </span>
<span class="sd">                single LTG flow identifier</span>

<span class="sd">        If the ltg_id_list is a single ID, then a single status tuple is</span>
<span class="sd">        returned.  If the ltg_id_list is a list of IDs, then a list of status</span>
<span class="sd">        tuples will be returned in the same order as the IDs in the list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            status (tuple):</span>
<span class="sd">            </span>
<span class="sd">                #. valid (bool): Is the LTG ID valid? (True/False)</span>
<span class="sd">                #. running (bool): Is the LTG currently running? (True/False)</span>
<span class="sd">                #. start_timestamp (int): Timestamp when the LTG started</span>
<span class="sd">                #. stop_timestamp (int): Timestamp when the LTG stopped</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ltg_id</span> <span class="ow">in</span> <span class="n">ltg_id_list</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStatus</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LTG_ERROR</span><span class="p">,</span> <span class="s">&quot;get status for LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
                <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStatus</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LTG_ERROR</span><span class="p">,</span> <span class="s">&quot;get status for LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>
            <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret_val</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_remove"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_remove">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ltg_id_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the LTG flows.</span>

<span class="sd">        Args:</span>
<span class="sd">            ltg_id_list (list of int, int): List of LTG flow identifiers or </span>
<span class="sd">                single LTG flow identifier</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ltg_id</span> <span class="ow">in</span> <span class="n">ltg_id_list</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGRemove</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;remove LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGRemove</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;remove LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_start"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_start">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ltg_id_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the LTG flow.</span>

<span class="sd">        Args:</span>
<span class="sd">            ltg_id_list (list of int, int): List of LTG flow identifiers or </span>
<span class="sd">                single LTG flow identifier</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ltg_id</span> <span class="ow">in</span> <span class="n">ltg_id_list</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStart</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;start LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStart</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;start LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_stop"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_stop">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ltg_id_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop the LTG flow to the given nodes.</span>

<span class="sd">        Args:</span>
<span class="sd">            ltg_id_list (list of int, int): List of LTG flow identifiers or </span>
<span class="sd">                single LTG flow identifier</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ltg_id</span> <span class="ow">in</span> <span class="n">ltg_id_list</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStop</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;stop LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStop</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;stop LTG {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ltg_id_list</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_remove_all"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_remove_all">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_remove_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops and removes all LTG flows on the node.&quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGRemove</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;remove all LTGs&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_start_all"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_start_all">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_start_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start all LTG flows on the node.&quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStart</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;start all LTGs&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.ltg_stop_all"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.ltg_stop_all">[docs]</a>    <span class="k">def</span> <span class="nf">ltg_stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop all LTG flows on the node.&quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">LTGStop</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_ltg_error</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s">&quot;stop all LTGs&quot;</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">_print_ltg_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Print an LTG error message.</span>

<span class="sd">        Args:</span>
<span class="sd">            status (int): Status of LTG command</span>
<span class="sd">            msg (str):    Message to print as part of LTG Error</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LTG_ERROR</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;LTG ERROR: Could not {0} on &#39;{1}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">))</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Configure Node Attribute Commands</span>
    <span class="c">#--------------------------------------------</span>
<div class="viewcode-block" id="WlanExpNode.reset_all"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.reset_all">[docs]</a>    <span class="k">def</span> <span class="nf">reset_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets all portions of a node.</span>

<span class="sd">        This includes:</span>
<span class="sd">        </span>
<span class="sd">          * Log</span>
<span class="sd">          * Counts</span>
<span class="sd">          * Local Traffic Generators (LTGs)</span>
<span class="sd">          * Queues</span>
<span class="sd">          * BSS (i.e. all network state)</span>
<span class="sd">          * Observed Networks</span>

<span class="sd">        See the reset() command for a list of all portions of the node that </span>
<span class="sd">        will be reset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">txrx_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">ltg</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">queue_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">bss</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                            <span class="n">network_list</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LTG_ERROR</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;LTG ERROR: Could not stop all LTGs on &#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.reset"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">txrx_counts</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ltg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">queue_data</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                    <span class="n">bss</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">network_list</span><span class="o">=</span><span class="bp">False</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Resets the state of node depending on the attributes.</span>

<span class="sd">        Args:</span>
<span class="sd">            log (bool):          Reset the log data.  This will reset both the </span>
<span class="sd">                log data on the node as well as the local variables used to </span>
<span class="sd">                track log reads for ``log_get_all_new()``.  This will </span>
<span class="sd">                not alter any log settings set by ``log_configure()``.</span>
<span class="sd">            txrx_counts (bool):  Reset the TX/RX Counts.  This will zero out </span>
<span class="sd">                all of the packet / byte counts as well as the </span>
<span class="sd">                ``latest_txrx_timestamp`` for all nodes in the station info </span>
<span class="sd">                list.  It will also remove all promiscuous counts.</span>
<span class="sd">            ltg (bool):          Remove all LTGs.  This will stop and remove</span>
<span class="sd">                any LTGs that are on the node.</span>
<span class="sd">            queue_data (bool):   Purge all TX queue data.  This will discard</span>
<span class="sd">                all currently enqueued packets awaiting transmission at the </span>
<span class="sd">                time the command is received.  This will not discard packets</span>
<span class="sd">                already submitted to the lower-level MAC for transmission.</span>
<span class="sd">                Also, this will not stop additional packets from sources </span>
<span class="sd">                such as LTGs from being enqueued.</span>
<span class="sd">            bss (bool):          Reset network state.  This will nullify</span>
<span class="sd">                the node&#39;s active BSS and removes all entries from the </span>
<span class="sd">                station info list.  However, it will not remove the BSS from </span>
<span class="sd">                the network list.  This will produce the following OTA</span>
<span class="sd">                transmissions:</span>
<span class="sd">                </span>
<span class="sd">                  * For AP, a deauthentication frame to each associated station</span>
<span class="sd">                  * For STA, a disassociation frame to its AP</span>
<span class="sd">                  * For IBSS, nothing. </span>
<span class="sd">                    </span>
<span class="sd">            network_list (bool): Remove all BSS entries from the network list,</span>
<span class="sd">                excluding the BSS entry for the node&#39;s current network (if any)            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_LOG</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_total_bytes_read</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_num_wraps</span>        <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_next_read_index</span>  <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">txrx_counts</span><span class="p">:</span>      <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_TXRX_COUNTS</span>
        <span class="k">if</span> <span class="n">ltg</span><span class="p">:</span>              <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_LTG</span>
        <span class="k">if</span> <span class="n">queue_data</span><span class="p">:</span>       <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_TX_DATA_QUEUE</span>
        <span class="k">if</span> <span class="n">bss</span><span class="p">:</span>              <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_BSS</span>
        <span class="k">if</span> <span class="n">network_list</span><span class="p">:</span>     <span class="n">flags</span> <span class="o">+=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_RESET_FLAG_NETWORK_LIST</span>

        <span class="c"># Send the reset command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeResetState</span><span class="p">(</span><span class="n">flags</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_wlan_mac_address"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_wlan_mac_address">[docs]</a>    <span class="k">def</span> <span class="nf">get_wlan_mac_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the WLAN MAC Address of the node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MAC Address (int):  </span>
<span class="sd">                Wireless Medium Access Control (MAC) address of the node.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcWLANMACAddr</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">addr</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wlan_mac_address</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">wlan_exp.util</span> <span class="kn">as</span> <span class="nn">util</span>

            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;WARNING:  WLAN MAC address mismatch.</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Received MAC Address:  {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">mac_addr_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Original MAC Address:  {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">mac_addr_to_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_mac_address</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">addr</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_mac_time"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_mac_time">[docs]</a>    <span class="k">def</span> <span class="nf">set_mac_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">time_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the MAC time on the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            time (int):              Time to which the node&#39;s MAC time will </span>
<span class="sd">                be set (int in microseconds)</span>
<span class="sd">            time_id (int, optional): Identifier used as part of the TIME_INFO </span>
<span class="sd">                log entry created by this command.  If not specified, then a </span>
<span class="sd">                random number will be used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">long</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Time must be expressed in int microseconds&quot;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTime</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">time_id</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_mac_time"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_mac_time">[docs]</a>    <span class="k">def</span> <span class="nf">get_mac_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the MAC time from the node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            time (int):  Timestamp of the MAC time of the node in int microseconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTime</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_RSVD_TIME</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">node_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_system_time"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_system_time">[docs]</a>    <span class="k">def</span> <span class="nf">get_system_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the system time from the node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Time (int):  Timestamp of the System time of the node in int microseconds</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTime</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_RSVD_TIME</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">node_time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="WlanExpNode.enable_beacon_mac_time_update"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.enable_beacon_mac_time_update">[docs]</a>    <span class="k">def</span> <span class="nf">enable_beacon_mac_time_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable / Disable MAC time update from beacons</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            enable (bool):  ``True`` enables and ``False`` disables MAC time </span>
<span class="sd">                updates from received beacons</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeConfigure</span><span class="p">(</span><span class="n">beacon_mac_time_update</span><span class="o">=</span><span class="n">enable</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_radio_channel"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_radio_channel">[docs]</a>    <span class="k">def</span> <span class="nf">set_radio_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channel</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Re-tune the node&#39;s RF interfaces to a new center frequency. </span>
<span class="sd">        </span>
<span class="sd">        This method directly controls the RF hardware. This can be disruptive </span>
<span class="sd">        to MAC operation if the node is currently associated with other nodes </span>
<span class="sd">        in a BSS which manages its own channel state.</span>
<span class="sd">        </span>
<span class="sd">        This method will immediately change the center frequency of the node&#39;s </span>
<span class="sd">        RF interfaces.  As a result this method can only be safely used on a </span>
<span class="sd">        node which is not currently a member of a BSS. To change the center </span>
<span class="sd">        frequency of nodes participating in a BSS use the </span>
<span class="sd">        ``node.configure_bss(channel=N)`` method on every node in the BSS.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            channel (int):  Channel index for new center frequency. Must be a </span>
<span class="sd">                valid channel index.  See ``wlan_channels`` in util.py for the </span>
<span class="sd">                list of supported channel indexes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.util</span> <span class="kn">as</span> <span class="nn">util</span>
        
        <span class="k">if</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">wlan_channels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcChannel</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">channel</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Channel must be in util.py wlan_channels&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_low_to_high_rx_filter"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_low_to_high_rx_filter">[docs]</a>    <span class="k">def</span> <span class="nf">set_low_to_high_rx_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mac_header</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">fcs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configures the filter that controls which received packets are </span>
<span class="sd">        passed from CPU Low to CPU High.</span>
<span class="sd">        </span>
<span class="sd">        The filter will always pass received packets where the destination </span>
<span class="sd">        address matches the node&#39;s MAC address. The filter can be configured </span>
<span class="sd">        to drop or pass other packets. This filter effectively controls which </span>
<span class="sd">        packets are written to the node&#39;s log.</span>

<span class="sd">        Args:</span>
<span class="sd">            mac_header (str, optional): MAC header filter.  Values can be:</span>
<span class="sd">               </span>
<span class="sd">               - ``&#39;MPDU_TO_ME&#39;`` -- Pass all unicast-to-me or multicast data or management packet</span>
<span class="sd">               - ``&#39;ALL_MPDU&#39;``   -- Pass all data and management packets; no destination address filter</span>
<span class="sd">               - ``&#39;ALL&#39;``        -- Pass all packets; no packet type or address filters</span>
<span class="sd">            </span>
<span class="sd">            fcs (str, optional): FCS status filter.  Values can be:</span>

<span class="sd">               - ``&#39;GOOD&#39;``       -- Pass only packets with good checksum result</span>
<span class="sd">               - ``&#39;ALL&#39;``        -- Pass packets with any checksum result</span>

<span class="sd">        At boot the filter defaults to ``mac_header=&#39;ALL&#39;`` and ``fcs=&#39;ALL&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeSetLowToHighFilter</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">mac_header</span><span class="p">,</span> <span class="n">fcs</span><span class="p">))</span>


    <span class="c">#------------------------</span>
    <span class="c"># Tx Rate commands</span>
</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_rate_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_rate_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_rate_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the unicast packet transmit rate (mcs, phy_mode) of the node.</span>

<span class="sd">        When using ``device_list`` or ``curr_assoc``, this method will set the </span>
<span class="sd">        unicast data packet tx rate since only unicast data transmit parameters </span>
<span class="sd">        are maintained for a given station info.  However, when using </span>
<span class="sd">        ``new_assoc``, this method will set both the default unicast data and </span>
<span class="sd">        unicast management packet tx rate.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcs (int): Modulation and coding scheme (MCS) index (in [0 .. 7])</span>
<span class="sd">            phy_mode (str, int): PHY mode.  Must be one of:</span>

<span class="sd">                * ``&#39;NONHT&#39;``: Use 802.11 (a/g) rates</span>
<span class="sd">                * ``&#39;HTMF&#39;``: Use 802.11 (n) rates</span>

<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to set the </span>
<span class="sd">                unicast packet Tx rate to the rate (mcs, phy_mdoe)</span>
<span class="sd">            curr_assoc (bool):  All current station infos will have the unicast </span>
<span class="sd">                packet Tx rate set to the rate (mcs, phy_mode)</span>
<span class="sd">            new_assoc  (bool):  All new station infos will have the unicast </span>
<span class="sd">                packet Tx rate set to the rate (mcs, phy_mode)</span>

<span class="sd">        One of ``device_list``, ``curr_assoc`` or ``new_assoc`` must be set.  </span>
<span class="sd">        The ``device_list`` and ``curr_assoc`` are mutually exclusive with </span>
<span class="sd">        ``curr_assoc`` having precedence (ie if ``curr_assoc`` is True, then </span>
<span class="sd">        ``device_list`` will be ignored).</span>

<span class="sd">        The MAC code does not differentiate between unicast management tx </span>
<span class="sd">        parameters and unicast data tx parameters since unicast management </span>
<span class="sd">        packets only occur when they will not materially affect an experiment </span>
<span class="sd">        (ie they are only sent during deauthentication)</span>

<span class="sd">        This will not affect the transmit antenna mode for control frames like </span>
<span class="sd">        ACKs that will be transmitted. The rate of control packets is </span>
<span class="sd">        determined by the 802.11 standard.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_node_set_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">,</span> <span class="s">&#39;rate&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">),</span> <span class="n">device_list</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Tx rate, (mcs, phy_mode) tuple, not supported by the design. See above error message.&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_rate_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_rate_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_rate_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast data packet transmit rate for a node.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcs (int): Modulation and coding scheme (MCS) index (in [0 .. 7])</span>
<span class="sd">            phy_mode (str, int): PHY mode.  Must be one of:</span>

<span class="sd">                * ``&#39;NONHT&#39;``: Use 802.11 (a/g) rates</span>
<span class="sd">                * ``&#39;HTMF&#39;``: Use 802.11 (n) rates</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">,</span> <span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Tx rate, (mcs, phy_mode) tuple, not supported by the design. See above error message.&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_rate_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_rate_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_rate_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast management packet transmit rate for a node.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcs (int): Modulation and coding scheme (MCS) index (in [0 .. 7])</span>
<span class="sd">            phy_mode (str, int): PHY mode.  Must be one of:</span>

<span class="sd">                * ``&#39;NONHT&#39;``: Use 802.11 (a/g) rates</span>
<span class="sd">                * ``&#39;HTMF&#39;``: Use 802.11 (n) rates</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">,</span> <span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_allowed_rate</span><span class="p">(</span><span class="n">mcs</span><span class="o">=</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="o">=</span><span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Tx rate, (mcs, phy_mode) tuple, not supported by the design. See above error message.&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_rate_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_rate_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_rate_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the unicast packet transmit rate of the node for the given </span>
<span class="sd">        device(s).</span>

<span class="sd">        This will get the unicast data packet tx rate (unicast managment </span>
<span class="sd">        packet tx rate is the same).</span>

<span class="sd">        Args:</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to get the </span>
<span class="sd">                unicast packet Tx rate</span>
<span class="sd">            new_assoc  (bool):  Get the unicast packet Tx rate for all new </span>
<span class="sd">                station infos</span>

<span class="sd">        Returns:</span>
<span class="sd">            rates (List of tuple):  </span>
<span class="sd">                List of unicast packet Tx rate tuples, (mcs, phy_mode), for </span>
<span class="sd">                the given devices.</span>

<span class="sd">        If both ``new_assoc`` and ``device_list`` are specified, the return </span>
<span class="sd">        list will always have the unicast packet Tx rate for all new </span>
<span class="sd">        station infos as the first item in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_get_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">,</span> <span class="s">&#39;rate&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">device_list</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_rate_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_rate_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_rate_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast data packet transmit rate for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            rate (tuple):  </span>
<span class="sd">                Multicast data packet transmit rate tuple, (mcs, phy_mode), </span>
<span class="sd">                for the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_rate_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_rate_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_rate_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast transmit rate for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            rate (tuple):  </span>
<span class="sd">                Multicast management packet transmit rate tuple, (mcs, </span>
<span class="sd">                phy_mode), for the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxRate</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">))</span>


    <span class="c">#------------------------</span>
    <span class="c"># Tx Antenna Mode commands</span>
</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_ant_mode_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_ant_mode_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_ant_mode_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the unicast packet transmit antenna mode of the node.</span>

<span class="sd">        When using ``device_list`` or ``curr_assoc``, this method will set the </span>
<span class="sd">        unicast data packet tx antenna mode since only unicast data transmit </span>
<span class="sd">        parameters are maintained for a given staion info.  However, when </span>
<span class="sd">        using ``new_assoc``, this method will set both the default unicast data </span>
<span class="sd">        and unicast management packet tx antenna mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            ant_mode (str):  Antenna mode; must be one of:</span>

<span class="sd">                * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to set the </span>
<span class="sd">                unicast packet Tx antenna mode to &#39;ant_mode&#39;</span>
<span class="sd">            curr_assoc (bool):  All current statoin infos will have the unicast </span>
<span class="sd">                packet Tx antenna mode set to &#39;ant_mode&#39;</span>
<span class="sd">            new_assoc  (bool):  All new station infos will have the unicast </span>
<span class="sd">                packet Tx antenna mode set to &#39;ant_mode&#39;</span>

<span class="sd">        One of ``device_list``, ``curr_assoc`` or ``new_assoc`` must be set.  </span>
<span class="sd">        The ``device_list`` and ``curr_assoc`` are mutually exclusive with </span>
<span class="sd">        ``curr_assoc`` having precedence. If ``curr_assoc`` is provided </span>
<span class="sd">        ``device_list`` will be ignored.</span>

<span class="sd">        The MAC code does not differentiate between unicast management tx </span>
<span class="sd">        parameters and unicast data tx parameters since unicast management </span>
<span class="sd">        packets only occur when they will not materially affect an experiment </span>
<span class="sd">        (ie they are only sent during deauthentication)</span>

<span class="sd">        This will not affect the transmit antenna mode for control frames like </span>
<span class="sd">        ACKs that will be transmitted. Control packets will be sent on whatever </span>
<span class="sd">        antenna that cause the control packet to be generated (ie an ack for a </span>
<span class="sd">        reception will go out on the same antenna on which the reception </span>
<span class="sd">        occurred).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ant_mode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid ant_mode: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ant_mode</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">_node_set_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">,</span> <span class="s">&#39;antenna mode&#39;</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">,</span> <span class="n">device_list</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_ant_mode_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_ant_mode_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_ant_mode_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast data packet transmit antenna mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            ant_mode (str):  Antenna mode; must be one of:</span>

<span class="sd">                * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ant_mode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid ant_mode: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ant_mode</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_ant_mode_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_ant_mode_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_ant_mode_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast management packet transmit antenna mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            ant_mode (str):  Antenna mode; must be one of:</span>

<span class="sd">                * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ant_mode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid ant_mode: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ant_mode</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_ant_mode_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_ant_mode_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_ant_mode_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the unicast packet transmit antenna mode of the node for the </span>
<span class="sd">        given device(s).</span>

<span class="sd">        This will get the unicast data packet Tx antenna mode (unicast </span>
<span class="sd">        managment packet Tx antenna mode is the same).</span>

<span class="sd">        Args:</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to get the </span>
<span class="sd">                unicast packet Tx antenna mode</span>
<span class="sd">            new_assoc  (bool):  Get the unicast packet Tx antenna mode for all </span>
<span class="sd">                new station infos</span>

<span class="sd">        Returns:</span>
<span class="sd">            ant_modes (List of str):  </span>
<span class="sd">                List of unicast packet Tx antenna mode for the given devices; </span>
<span class="sd">                each antenna mode must be one of:</span>

<span class="sd">                  * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                  * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        If both ``new_assoc`` and ``device_list`` are specified, the return </span>
<span class="sd">        list will always have the unicast packet Tx antenna mode for all new </span>
<span class="sd">        station infos as the first item in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_get_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">,</span> <span class="s">&#39;antenna mode&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">device_list</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_ant_mode_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_ant_mode_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_ant_mode_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast data packet transmit antenna mode for </span>
<span class="sd">        a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ant_mode (str):  </span>
<span class="sd">                Multicast data packet transmit antenna mode for the node; </span>
<span class="sd">                must be one of:</span>

<span class="sd">                  * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                  * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_ant_mode_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_ant_mode_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_ant_mode_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast management packet transmit antenna mode for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ant_mode (str):  </span>
<span class="sd">                Multicast management packet transmit antenna mode for the node;</span>
<span class="sd">                must be one of:</span>

<span class="sd">                  * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                  * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">))</span>

</div>
    <span class="k">def</span> <span class="nf">set_tx_ant_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the transmit antenna mode of the node.</span>

<span class="sd">        This command will set all transmit antenna mode fields on the node to the same value:</span>
<span class="sd">        </span>
<span class="sd">            * Default Unicast Management Packet Tx Antenna mode for new station infos</span>
<span class="sd">            * Default Unicast Data Packet Tx Tx Antenna mode for new station infos</span>
<span class="sd">            * Default Multicast Management Packet Tx Antenna mode for new station infos</span>
<span class="sd">            * Default Multicast Data Packet Tx Antenna mode for new station infos</span>

<span class="sd">        It will also update the transmit antenna mode of all current station infos on the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            ant_mode (str):  Antenna mode; must be one of:</span>

<span class="sd">                * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ant_mode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid ant_mode: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ant_mode</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_TX_ANT_ALL</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">get_tx_ant_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current default unicast data transmit antenna mode of the </span>
<span class="sd">        node for new station infos.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ant_mode (str):  </span>
<span class="sd">                Current unicast packet Tx antenna mode; must be one of:</span>

<span class="sd">                  * ``&#39;RF_A&#39;``: transmit on RF A interface</span>
<span class="sd">                  * ``&#39;RF_B&#39;``: transmit on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tx_ant_mode_unicast</span><span class="p">(</span><span class="n">new_assoc</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c">#------------------------</span>
    <span class="c"># Rx Antenna Mode commands</span>

<div class="viewcode-block" id="WlanExpNode.set_rx_ant_mode"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_rx_ant_mode">[docs]</a>    <span class="k">def</span> <span class="nf">set_rx_ant_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the receive antenna mode for a node.</span>

<span class="sd">        Args:</span>
<span class="sd">            ant_mode (str):  Antenna mode; must be one of:</span>

<span class="sd">                * ``&#39;RF_A&#39;``: receive on RF A interface</span>
<span class="sd">                * ``&#39;RF_B&#39;``: receive on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ant_mode</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid ant_mode: {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ant_mode</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcRxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">ant_mode</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_rx_ant_mode"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_rx_ant_mode">[docs]</a>    <span class="k">def</span> <span class="nf">get_rx_ant_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current receive antenna mode for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            ant_mode (str):  </span>
<span class="sd">                Rx Antenna mode; must be one of:</span>

<span class="sd">                  * ``&#39;RF_A&#39;``: receive on RF A interface</span>
<span class="sd">                  * ``&#39;RF_B&#39;``: receive on RF B interface</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcRxAntMode</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">))</span>


    <span class="c">#------------------------</span>
    <span class="c"># Tx Power commands</span>
</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_power_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_power_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_power_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the unicast packet transmit power of the node.</span>

<span class="sd">        When using ``device_list`` or ``curr_assoc``, this method will set the </span>
<span class="sd">        unicast data packet tx power since only unicast data transmit </span>
<span class="sd">        parameters are maintained for a given station info.  However, when </span>
<span class="sd">        using ``new_assoc``, this method will set both the default unicast </span>
<span class="sd">        data and unicast management packet tx power.</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int):  Transmit power in dBm (a value between </span>
<span class="sd">                ``node.max_tx_power_dbm`` and ``node.min_tx_power_dbm``)</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to set the </span>
<span class="sd">                unicast packet Tx power to &#39;power&#39;</span>
<span class="sd">            curr_assoc (bool):  All current station infos will have the unicast </span>
<span class="sd">                packet Tx power set to &#39;power&#39;</span>
<span class="sd">            new_assoc  (bool):  All new station infos will have the unicast </span>
<span class="sd">                packet Tx power set to &#39;power&#39;</span>

<span class="sd">        One of ``device_list``, ``curr_assoc`` or ``new_assoc`` must be set.  </span>
<span class="sd">        The ``device_list`` and ``curr_assoc`` are mutually exclusive with </span>
<span class="sd">        ``curr_assoc`` having precedence (ie if ``curr_assoc`` is True, then </span>
<span class="sd">        ``device_list`` will be ignored).</span>

<span class="sd">        The MAC code does not differentiate between unicast management tx </span>
<span class="sd">        parameters and unicast data tx parameters since unicast management </span>
<span class="sd">        packets only occur when they will not materially affect an experiment </span>
<span class="sd">        (ie they are only sent during deauthentication)</span>

<span class="sd">        This will not affect the transmit power for control frames like ACKs </span>
<span class="sd">        that will be transmitted. To adjust this power, use the </span>
<span class="sd">        ``set_tx_power_ctrl`` command</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_node_set_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">,</span> <span class="s">&#39;tx power&#39;</span><span class="p">,</span> 
                                        <span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">),</span> 
                                        <span class="n">device_list</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_power_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_power_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_power_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast data packet transmit power.</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int):  Transmit power in dBm (a value between </span>
<span class="sd">                ``node.max_tx_power_dbm`` and ``node.min_tx_power_dbm``)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">,</span> 
                                           <span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_power_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_power_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_power_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the multicast management packet transmit power.</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int):  Transmit power in dBm (a value between </span>
<span class="sd">                ``node.max_tx_power_dbm`` and ``node.min_tx_power_dbm``)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">,</span> 
                                           <span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_power_unicast"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_power_unicast">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_power_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the unicast packet transmit power of the node for the given </span>
<span class="sd">        device(s).</span>

<span class="sd">        This will get the unicast data packet Tx power (unicast managment </span>
<span class="sd">        packet Tx power is the same).</span>

<span class="sd">        Args:</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to get the </span>
<span class="sd">                unicast packet Tx power</span>
<span class="sd">            new_assoc  (bool):  Get the unicast packet Tx power for all new </span>
<span class="sd">                station infos</span>

<span class="sd">        Returns:</span>
<span class="sd">            tx_powers (List of int):  </span>
<span class="sd">                List of unicast packet Tx power for the given devices.</span>

<span class="sd">        If both ``new_assoc`` and ``device_list`` are specified, the return </span>
<span class="sd">        list will always have the unicast packet Tx power for all new </span>
<span class="sd">        station infos as the first item in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node_get_tx_param_unicast</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">,</span> <span class="s">&#39;tx power&#39;</span><span class="p">,</span> 
                                               <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">),</span> 
                                               <span class="n">device_list</span><span class="p">,</span> <span class="n">new_assoc</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_power_multicast_data"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_power_multicast_data">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_power_multicast_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast data packet transmit power for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tx_power (int):  </span>
<span class="sd">                Multicast data packet transmit power for the node in dBm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_DATA</span><span class="p">,</span>
                                                  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_power_multicast_mgmt"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_power_multicast_mgmt">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_power_multicast_mgmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current multicast management packet transmit power for a node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tx_power (int):  </span>
<span class="sd">                Multicast management packet transmit power for the node in dBm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_MULTICAST_MGMT</span><span class="p">,</span> 
                                                  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_power_ctrl"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_power_ctrl">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_power_ctrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the control packet transmit power of the node.</span>

<span class="sd">        Only the Tx power of the control packets can be set via wlan_exp.  The </span>
<span class="sd">        rate of control packets is determined by the 802.11 standard and </span>
<span class="sd">        control packets will be sent on whatever antenna that cause the control </span>
<span class="sd">        packet to be generated (ie an ack for a reception will go out on the </span>
<span class="sd">        same antenna on which the reception occurred).</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int):  Transmit power in dBm (a value between </span>
<span class="sd">                ``node.max_tx_power_dbm`` and ``node.min_tx_power_dbm``)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_TX_POWER_LOW</span><span class="p">,</span> 
                                           <span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_tx_power"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_tx_power">[docs]</a>    <span class="k">def</span> <span class="nf">set_tx_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">power</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the transmit power of the node.</span>

<span class="sd">        This command will set all transmit power fields on the node to the same </span>
<span class="sd">        value:</span>
<span class="sd">        </span>
<span class="sd">            * Default Unicast Management Packet Tx Power for new station infos</span>
<span class="sd">            * Default Unicast Data Packet Tx Power for new station infos</span>
<span class="sd">            * Default Multicast Management Packet Tx Power for new station infos</span>
<span class="sd">            * Default Multicast Data Packet Tx Power for new station infos</span>
<span class="sd">            * Control Packet Tx Power</span>

<span class="sd">        It will also update the transmit power of all current station infos</span>
<span class="sd">        that are part of the BSS on the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            power (int):  Transmit power in dBm (a value between </span>
<span class="sd">                ``node.max_tx_power_dbm`` and ``node.min_tx_power_dbm``)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcTxPower</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_TX_POWER_ALL</span><span class="p">,</span> 
                                           <span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span><span class="p">)))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_tx_power"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_tx_power">[docs]</a>    <span class="k">def</span> <span class="nf">get_tx_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the current default unicast data transmit power of the node </span>
<span class="sd">        for new station infos.</span>

<span class="sd">        Returns:</span>
<span class="sd">            tx_power (int): Current unicast data transmit power in dBm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tx_power_unicast</span><span class="p">(</span><span class="n">new_assoc</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c">#------------------------</span>
    <span class="c"># Other commands</span>
</div>
<div class="viewcode-block" id="WlanExpNode.set_low_param"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_low_param">[docs]</a>    <span class="k">def</span> <span class="nf">set_low_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_id</span><span class="p">,</span> <span class="n">param_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set a CPU Low parameter</span>

<span class="sd">        This command provides a generic data pipe to set parameters in CPU Low.  </span>
<span class="sd">        Currently supported parameters are defined in cmds.py and use the </span>
<span class="sd">        naming convention:  CMD_PARAM_LOW_PARAM_*   In some cases, additional </span>
<span class="sd">        commands have been added to the node that utilize ``set_low_param()``</span>
<span class="sd">        in order to add error checking.</span>

<span class="sd">        See http://warpproject.org/trac/wiki/802.11/wlan_exp/Extending</span>
<span class="sd">        for more information about how to extend ``set_low_param()`` to </span>
<span class="sd">        control additional parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            param_id (int):              ID of parameter to be set</span>
<span class="sd">            param_values (list of int):  Value(s) to set the parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">param_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">v0</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">v0</span> <span class="o">=</span> <span class="n">param_values</span>

            <span class="k">if</span><span class="p">((</span><span class="nb">type</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">long</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="n">v0</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: parameter values must be scalar or iterable of ints in [0,2^32-1]!&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">param_values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_values</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeLowParam</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">param_id</span><span class="o">=</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">values</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_dcf_param"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_dcf_param">[docs]</a>    <span class="k">def</span> <span class="nf">set_dcf_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configures parameters of the DCF MAC in CPU Low. </span>
<span class="sd">        </span>
<span class="sd">        These parameters are write-only. These parameters only affect nodes </span>
<span class="sd">        running the DCF in CPU Low. Other MAC implementations should ignore </span>
<span class="sd">        these parameter updates.</span>

<span class="sd">        Args:</span>
<span class="sd">            param_name (str): Name of the param to change (see table below)</span>
<span class="sd">            param_val (int): Value to set for param_name (see table below)</span>

<span class="sd">        This method currently implements the following parameters:</span>

<span class="sd">        .. list-table::</span>
<span class="sd">            :header-rows: 1</span>
<span class="sd">            :widths: 15 20 60</span>

<span class="sd">            * - Name</span>
<span class="sd">              - Valid Values</span>
<span class="sd">              - Description</span>

<span class="sd">            * - ``&#39;rts_thresh&#39;``</span>
<span class="sd">              - [0 .. 65535]</span>
<span class="sd">              - Threshold in bytes for maximum length </span>
<span class="sd">                packet which will not trigger RTS handshake</span>

<span class="sd">            * - ``&#39;short_retry_limit&#39;`` and</span>
<span class="sd">                ``&#39;long_retry_limit&#39;``</span>
<span class="sd">              - [0 .. 10]</span>
<span class="sd">              - DCF retry limits, controls maximum number of retransmissions for short and long packets</span>
<span class="sd">                See `retransmissions &lt;http://warpproject.org/trac/wiki/802.11/MAC/Lower/Retransmissions&gt;`_.</span>
<span class="sd">                for more details.</span>

<span class="sd">            * - ``&#39;phy_cs_thresh&#39;``</span>
<span class="sd">              - [0 .. 1023]</span>
<span class="sd">              - Physical carrier sensing threshold, in units of digital RSSI. Set to max (1023) </span>
<span class="sd">                to effectively disable physical carrier sensing</span>

<span class="sd">            * - ``&#39;cw_exp_min&#39;`` and</span>
<span class="sd">                ``&#39;cw_exp_max&#39;``</span>
<span class="sd">              - [1 .. 16]</span>
<span class="sd">              - Contention window exponent bounds. Contention window is set to random number in [0, (2^CW - 1)], </span>
<span class="sd">                where CW is bounded by [cw_exp_min, cw_exp_max]</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;param_name must be a str.  Provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">param_name</span><span class="p">)))</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">param_val</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;param_val must be an int.  Provided {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">param_val</span><span class="p">)))</span>
        
        <span class="c"># Process paramater </span>
        <span class="k">if</span>   <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;rts_thresh&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;rts_thresh&#39; must be in [0 .. 65535].&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;rts_thresh&#39;)&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_RTS_THRESH</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;short_retry_limit&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;short_retry_limit&#39; must be in [0 .. 10].&quot;</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;short_retry_limit&#39;)&quot;</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_DOT11SHORTRETRY</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;long_retry_limit&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;long_retry_limit&#39; must be in [0 .. 10].&quot;</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;long_retry_limit&#39;)&quot;</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_DOT11LONGRETRY</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;phy_cs_thresh&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">1023</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;phy_cs_thresh&#39; must be in [0 .. 1023].&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;phy_cs_thresh&#39;)&quot;</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_PHYSICAL_CS_THRESH</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;cw_exp_min&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;cw_exp_min&#39; must be in [1 .. 16].&quot;</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;cw_exp_min&#39;)&quot;</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_CW_EXP_MIN</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="p">(</span><span class="n">param_name</span> <span class="o">==</span> <span class="s">&#39;cw_exp_max&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">param_val</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">param_val</span> <span class="o">&gt;</span> <span class="mi">16</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;cw_exp_max&#39; must be in [1 .. 16].&quot;</span><span class="p">)</span>
                
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_cpu_low_type</span><span class="p">(</span><span class="n">low_type</span><span class="o">=</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_DCF</span><span class="p">,</span> <span class="n">command_name</span><span class="o">=</span><span class="s">&quot;set_dcf_param(&#39;cw_exp_max&#39;)&quot;</span><span class="p">)</span>
    
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_DCF_CW_EXP_MAX</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param_val</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;param_name must be one of the following strings:</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    &#39;rts_thresh&#39;, &#39;short_retry_limit&#39;, &#39;long_retry_limit&#39;, </span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    &#39;phy_cs_thresh&#39;, &#39;cw_exp_min&#39;, &#39;cw_exp_max&#39; </span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;Provided &#39;{0}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.configure_pkt_det_min_power"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.configure_pkt_det_min_power">[docs]</a>    <span class="k">def</span> <span class="nf">configure_pkt_det_min_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">,</span> <span class="n">power_level</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure Minimum Power Requirement of Packet Detector.</span>

<span class="sd">        Args:</span>
<span class="sd">            enable (bool):      True/False</span>
<span class="sd">            power_level (int):  [-90,-30] dBm</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">enable</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_PKT_DET_MIN_POWER</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">power_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">power_level</span> <span class="o">&gt;=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_MIN_MIN_PKT_DET_POWER_DBM</span> <span class="ow">and</span> <span class="n">power_level</span> <span class="o">&lt;=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_MAX_MIN_PKT_DET_POWER_DBM</span><span class="p">:</span>
                    <span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">power_level</span><span class="o">+</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_MIN_MIN_PKT_DET_POWER_DBM</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_PKT_DET_MIN_POWER</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">param</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Power level must be in the range of [{0},{1}]</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_MIN_MIN_PKT_DET_POWER_DBM</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_NODE_MAX_MIN_PKT_DET_POWER_DBM</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Power level not specified</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_phy_samp_rate"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_phy_samp_rate">[docs]</a>    <span class="k">def</span> <span class="nf">set_phy_samp_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phy_samp_rate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the PHY sample rate (in MSps)</span>

<span class="sd">        Args:</span>
<span class="sd">            phy_samp_rate (int):    </span>
<span class="sd">                PHY sample rate in MSps (10, 20, 40).  Default is 20 MSps.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">phy_samp_rate</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;&#39;phy_samp_rate&#39; must be in [10, 20, 40].&quot;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_PHY_SAMPLE_RATE</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">phy_samp_rate</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_random_seed"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_random_seed">[docs]</a>    <span class="k">def</span> <span class="nf">set_random_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">high_seed</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">low_seed</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gen_random</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the random number generator seed on the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            high_seed (int, optional):   Set the random number generator seed </span>
<span class="sd">                on CPU high</span>
<span class="sd">            low_seed (int, optional):    Set the random number generator seed </span>
<span class="sd">                on CPU low</span>
<span class="sd">            gen_random (bool, optional): If high_seed or low_seed is not </span>
<span class="sd">                provided, then generate a random seed for the generator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">random</span>
        <span class="n">max_seed</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">min_seed</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">high_seed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">gen_random</span><span class="p">:</span>
                <span class="n">high_seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">min_seed</span><span class="p">,</span> <span class="n">max_seed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">high_seed</span> <span class="o">&gt;</span> <span class="n">max_seed</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">high_seed</span> <span class="o">&lt;</span> <span class="n">min_seed</span><span class="p">):</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;Seed must be an integer between [{0}, {1}]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_seed</span><span class="p">,</span> <span class="n">max_seed</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">low_seed</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">gen_random</span><span class="p">:</span>
                <span class="n">low_seed</span>  <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">min_seed</span><span class="p">,</span> <span class="n">max_seed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">low_seed</span> <span class="o">&gt;</span> <span class="n">max_seed</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">low_seed</span> <span class="o">&lt;</span> <span class="n">min_seed</span><span class="p">):</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;Seed must be an integer between [{0}, {1}]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_seed</span><span class="p">,</span> <span class="n">max_seed</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcRandomSeed</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">high_seed</span><span class="p">,</span> <span class="n">low_seed</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.enable_dsss"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.enable_dsss">[docs]</a>    <span class="k">def</span> <span class="nf">enable_dsss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable / Disable DSSS receptions on the node</span>

<span class="sd">        By default DSSS receptions are enabled on the node when possible </span>
<span class="sd">        (ie PHY sample rate is 20 MHz and Channel is in 2.4 GHz band)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            enable (bool):  </span>
<span class="sd">            </span>
<span class="sd">              * True - enable DSSS receptions on the node</span>
<span class="sd">              * False - disable DSSS receptions on the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeConfigure</span><span class="p">(</span><span class="n">dsss_enable</span><span class="o">=</span><span class="n">enable</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.set_print_level"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_print_level">[docs]</a>    <span class="k">def</span> <span class="nf">set_print_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the verbosity of the wlan_exp output to the node&#39;s UART.</span>

<span class="sd">        Args:</span>
<span class="sd">            level (int):  Printing level (defaults to ``WARNING``)</span>

<span class="sd">        Valid print levels can be found in ``wlan_exp.util.uart_print_levels``:</span>
<span class="sd">        </span>
<span class="sd">          * ``NONE``    - Do not print messages</span>
<span class="sd">          * ``ERROR``   - Only print error messages</span>
<span class="sd">          * ``WARNING`` - Print error and warning messages</span>
<span class="sd">          * ``INFO``    - Print error, warning and info messages</span>
<span class="sd">          * ``DEBUG``   - Print error, warning, info and debug messages</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.util</span> <span class="kn">as</span> <span class="nn">util</span>
        
        <span class="n">valid_levels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;NONE&#39;</span><span class="p">,</span> <span class="s">&#39;ERROR&#39;</span><span class="p">,</span> <span class="s">&#39;WARNING&#39;</span><span class="p">,</span> <span class="s">&#39;INFO&#39;</span><span class="p">,</span> <span class="s">&#39;DEBUG&#39;</span><span class="p">,</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">uart_print_levels</span><span class="p">[</span><span class="s">&#39;NONE&#39;</span><span class="p">],</span> 
                        <span class="n">util</span><span class="o">.</span><span class="n">uart_print_levels</span><span class="p">[</span><span class="s">&#39;ERROR&#39;</span><span class="p">],</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">uart_print_levels</span><span class="p">[</span><span class="s">&#39;WARNING&#39;</span><span class="p">],</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">uart_print_levels</span><span class="p">[</span><span class="s">&#39;INFO&#39;</span><span class="p">],</span>
                        <span class="n">util</span><span class="o">.</span><span class="n">uart_print_levels</span><span class="p">[</span><span class="s">&#39;DEBUG&#39;</span><span class="p">]]</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">level</span> <span class="ow">in</span> <span class="n">valid_levels</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeConfigure</span><span class="p">(</span><span class="n">print_level</span><span class="o">=</span><span class="n">level</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Invalid print level {0}.  Print level must be one of: </span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    [&#39;NONE&#39;, &#39;ERROR&#39;, &#39;WARNING&#39;, &#39;INFO&#39;, &#39;DEBUG&#39;, </span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;     uart_print_levels[&#39;NONE&#39;], uart_print_levels[&#39;ERROR&#39;],</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;     uart_print_levels[&#39;WARNING&#39;], uart_print_levels[&#39;INFO&#39;],</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;     uart_print_levels[&#39;DEBUG&#39;]]&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            


    <span class="c">#--------------------------------------------</span>
    <span class="c"># Internal methods to view / configure node attributes</span>
    <span class="c">#--------------------------------------------</span></div>
    <span class="k">def</span> <span class="nf">_check_allowed_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check that rate parameters are allowed</span>

<span class="sd">        Args:</span>
<span class="sd">            mcs (int):           Modulation and coding scheme (MCS) index</span>
<span class="sd">            phy_mode (str, int): PHY mode (from util.phy_modes)</span>

<span class="sd">        Returns:</span>
<span class="sd">            valid (bool):  Are all parameters valid?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_supported_rate</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_check_supported_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mcs</span><span class="p">,</span> <span class="n">phy_mode</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks that the selected rate parameters are supported by the</span>
<span class="sd">        current MAC and PHY implementation. This method only checks if a</span>
<span class="sd">        rate can be used in hardware. The application-specific method</span>
<span class="sd">        _check_allowed_rate() should be used to confirm a selected rate is</span>
<span class="sd">        both supported and allowed given the currnet MAC and network state.</span>

<span class="sd">        Args:</span>
<span class="sd">            mcs (int): Modulation and coding scheme (MCS) index (in [0 .. 7])</span>
<span class="sd">            phy_mode (str, int): PHY mode.  Must be one of:</span>

<span class="sd">                * ``&#39;NONHT&#39;``: Use 802.11 (a/g) rates</span>
<span class="sd">                * ``&#39;HTMF&#39;``: Use 802.11 (n) rates</span>

<span class="sd">        Returns:</span>
<span class="sd">            rate_suppored (bool):  True if the specified rate is supported</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.util</span> <span class="kn">as</span> <span class="nn">util</span>

        <span class="n">rate_ok</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="k">if</span> <span class="p">((</span><span class="n">mcs</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mcs</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Invalid MCS {0}. MCS must be integer in [0 .. 7]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mcs</span><span class="p">))</span>
            <span class="n">rate_ok</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">phy_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;NONHT&#39;</span><span class="p">,</span> <span class="s">&#39;HTMF&#39;</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">phy_modes</span><span class="p">[</span><span class="s">&#39;NONHT&#39;</span><span class="p">],</span> <span class="n">util</span><span class="o">.</span><span class="n">phy_modes</span><span class="p">[</span><span class="s">&#39;HTMF&#39;</span><span class="p">]]):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">verbose</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Invalid PHY mode {0}. PHY mode must be one of [&#39;NONHT&#39;, &#39;HTMF&#39;, phy_modes[&#39;NONHT&#39;], phy_modes[&#39;HTMF&#39;]]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">phy_mode</span><span class="p">))</span>
            <span class="n">rate_ok</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">return</span> <span class="n">rate_ok</span>


    <span class="k">def</span> <span class="nf">_node_set_tx_param_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span>
                                         <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">curr_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the unicast transmit param of the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            cmd (Cmd):          Command to be used to set param</span>
<span class="sd">            param_name (str):   Name of parameter for error messages</span>
<span class="sd">            param (int):        Parameter to be set</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to set the Tx </span>
<span class="sd">                unicast param</span>
<span class="sd">            curr_assoc (bool):  All current station infos will have Tx unicast </span>
<span class="sd">                param set</span>
<span class="sd">            new_assoc  (bool):  All new staion infos will have Tx unicast </span>
<span class="sd">                param set</span>

<span class="sd">        One of ``device_list``, ``curr_assoc`` or ``new_assoc`` must be set.  </span>
<span class="sd">        The ``device_list`` and ``curr_assoc`` are mutually exclusive with </span>
<span class="sd">        ``curr_assoc`` having precedence (ie if ``curr_assoc`` is True, then </span>
<span class="sd">        ``device_list`` will be ignored).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">device_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">curr_assoc</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">new_assoc</span><span class="p">):</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Cannot set the unicast transmit {0}:</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Must specify either a list of devices, all current station infos,</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    or all new station infos on which to set the {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_assoc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE_DEFAULT</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">curr_assoc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">device_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">device_list</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">device</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">device_list</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_node_get_tx_param_unicast</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">new_assoc</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gets the unicast transmit param of the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            cmd (Cmd):          Command to be used to set param</span>
<span class="sd">            param_name (str):   Name of parameter for error messages</span>
<span class="sd">            param (int):        Optional parameter to pass information to cmd</span>
<span class="sd">            device_list (list of WlanExpNode / WlanDevice, optional):  List of </span>
<span class="sd">                802.11 devices or single 802.11 device for which to get the Tx </span>
<span class="sd">                unicast param</span>
<span class="sd">            new_assoc  (bool):  Get the Tx unicast param for all new station infos</span>

<span class="sd">        Returns:</span>
<span class="sd">            params (List of params):  </span>
<span class="sd">                List of Tx unicast param for the given devices.</span>

<span class="sd">        If both ``new_assoc`` and ``device_list`` are specified, the return </span>
<span class="sd">        list will always have the Tx unicast rate for all new station infos as </span>
<span class="sd">        the first item in the list.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">device_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">new_assoc</span><span class="p">):</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Cannot get the unicast transmit {0}:</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Must specify either a list of devices or all new station infos</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    for which to get the {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_assoc</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ_DEFAULT</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">))</span>
            <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">device_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">device_list</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">))</span>
                    <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_UNICAST</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device_list</span><span class="p">))</span>
                <span class="n">ret_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret_val</span>


    <span class="k">def</span> <span class="nf">_set_bb_gain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bb_gain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the the baseband gain.</span>

<span class="sd">        Args:</span>
<span class="sd">            bb_gain (int):  Baseband gain setting [0,3]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bb_gain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">bb_gain</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bb_gain</span> <span class="o">&lt;=</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_BB_GAIN</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">bb_gain</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">BB Gain must be in the range [0,3]</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_set_linearity_pa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linearity_val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the the PA linearity.</span>

<span class="sd">        Args:</span>
<span class="sd">            linearity_val (int):  Linearity setting [0,3]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">linearity_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&lt;=</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_LINEARITY_PA</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">linearity_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">BB Linearity must be in the range [0,3]</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_set_interp_filt_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale_int0</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">scale_int1</span><span class="o">=</span><span class="mh">0x10</span><span class="p">,</span> <span class="n">scale_srrc</span><span class="o">=</span><span class="mh">0x10</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the the DAC scaling at the output of each stage of interpolations.</span>

<span class="sd">        Args:</span>
<span class="sd">            scale_int0 (int):  Scaling Stage 0    [0,31]</span>
<span class="sd">            scale_int1 (int):  Scaling Stage 0    [0,31]</span>
<span class="sd">            scale_srrc (int):  Scaling Stage SRRC [0,31]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">scale_int0</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">scale_int0</span> <span class="o">&lt;=</span><span class="mi">31</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">scale_int1</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">scale_int1</span> <span class="o">&lt;=</span><span class="mi">31</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">scale_srrc</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">scale_srrc</span> <span class="o">&lt;=</span><span class="mi">31</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_AD_SCALING</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="p">[</span><span class="n">scale_int0</span><span class="p">,</span> <span class="n">scale_int1</span><span class="p">,</span> <span class="n">scale_srrc</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Interp scalings must be in the range [0,31]</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_set_linearity_vga</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linearity_val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the the VGA linearity.</span>

<span class="sd">        Args:</span>
<span class="sd">            linearity_val (int):  Linearity setting [0,3]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">linearity_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&lt;=</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_LINEARITY_VGA</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">linearity_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">BB Linearity must be in the range [0,3]</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_set_linearity_upconv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linearity_val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the the upconversion linearity.</span>

<span class="sd">        Args:</span>
<span class="sd">            linearity_val (int):  Linearity setting [0,3]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">linearity_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">linearity_val</span> <span class="o">&lt;=</span><span class="mi">3</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_low_param</span><span class="p">(</span><span class="n">param_id</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_LOW_PARAM_LINEARITY_UPCONV</span><span class="p">,</span> <span class="n">param_values</span><span class="o">=</span><span class="n">linearity_val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">BB Linearity must be in the range [0,3]</span><span class="se">\n</span><span class="s">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Scan Commands</span>
    <span class="c">#--------------------------------------------</span>
<div class="viewcode-block" id="WlanExpNode.set_scan_parameters"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.set_scan_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_scan_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_per_channel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">num_probe_tx_per_channel</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">channel_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ssid</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the paramters of the wireless network scan state machine.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            time_per_channel (float, optional): Time (in float sec) to spend </span>
<span class="sd">                on each channel.  A value of None will not modify the current</span>
<span class="sd">                time per channel</span>
<span class="sd">            num_probe_tx_per_channel (int, optional):   Number of probe requests </span>
<span class="sd">                transmitted while on each channel.  A value of None will not </span>
<span class="sd">                modify the current number of probe requests per channel.</span>
<span class="sd">            channel_list (list of int optional): Channel(s) to scan; A value </span>
<span class="sd">                of None will not modify the current channel list.</span>
<span class="sd">            ssid (str, optional):  SSID to scan for (as part of probe request);</span>
<span class="sd">                A value of None will not modify the current SSID.</span>
<span class="sd">        </span>
<span class="sd">        Setting ``num_probe_tx_per_chan`` to a non-zero value will enable </span>
<span class="sd">        active scanning. The node will transmit broadcast Probe Request packets </span>
<span class="sd">        on every channel and will gather network information from received </span>
<span class="sd">        Probe Response and Beacon packets. Setting ``num_probe_tx_per_chan=0`` </span>
<span class="sd">        will enable passive scanning. In this mode the node will not transmit </span>
<span class="sd">        any Probe Request packets and network information will be gathered only </span>
<span class="sd">        from received Beacon packets.</span>

<span class="sd">        The blank SSID (``ssid=&quot;&quot;``) is interpretted as a wildcard and will </span>
<span class="sd">        solicit Probe Response packets from networks with any SSID. &quot;Closed&quot; </span>
<span class="sd">        networks do not respond to the wildcard SSID. These networks will still </span>
<span class="sd">        be discovered via Beacon receptions.</span>

<span class="sd">        If the channel list / SSID is not specified, then it will not be </span>
<span class="sd">        updated on the node (ie it will use the current channel list / SSID)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Check time_per_channel</span>
        <span class="k">if</span> <span class="n">time_per_channel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">time_per_channel</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">time_per_channel</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;time_per_channel must be expressable as a float.&quot;</span><span class="p">)</span>
                
        <span class="c"># Check channel_list</span>
        <span class="k">if</span> <span class="n">channel_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">tmp_chan_list</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="c"># Process pre-defined strings</span>
                <span class="kn">import</span> <span class="nn">wlan_exp.util</span> <span class="kn">as</span> <span class="nn">util</span>

                <span class="k">if</span>   <span class="p">(</span><span class="n">channel_list</span> <span class="o">==</span> <span class="s">&#39;ALL&#39;</span><span class="p">):</span>
                    <span class="n">tmp_chan_list</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">wlan_channels</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">channel_list</span> <span class="o">==</span> <span class="s">&#39;ALL_2.4GHZ&#39;</span><span class="p">):</span>
                    <span class="n">tmp_chan_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">wlan_channels</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">14</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">channel_list</span> <span class="o">==</span> <span class="s">&#39;ALL_5GHZ&#39;</span><span class="p">):</span>
                    <span class="n">tmp_chan_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">util</span><span class="o">.</span><span class="n">wlan_channels</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">)]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    String &#39;{0}&#39; not recognized.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    Please use &#39;ALL&#39;, &#39;ALL_2.4GHZ&#39;, &#39;ALL_5GHZ&#39; or either an int or list of channels&quot;</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
                <span class="c"># Proess scalar integer</span>
                <span class="n">tmp_chan_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># Proess interables</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">channel_list</span><span class="p">:</span>
                        <span class="n">tmp_chan_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    Unable to process channel_list.&quot;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    Please use &#39;ALL&#39;, &#39;ALL_2.4GHZ&#39;, &#39;ALL_5GHZ&#39; or either an int or list of channels&quot;</span>
                    <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tmp_chan_list</span><span class="p">:</span>
                <span class="n">channel_list</span> <span class="o">=</span> <span class="n">tmp_chan_list</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    channel_list is empty.&quot;</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">    Please use &#39;ALL&#39;, &#39;ALL_2.4GHZ&#39;, &#39;ALL_5GHZ&#39; or either an int or list of channels&quot;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcScanParam</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">time_per_channel</span><span class="p">,</span> <span class="n">num_probe_tx_per_channel</span><span class="p">,</span> <span class="n">channel_list</span><span class="p">,</span> <span class="n">ssid</span><span class="p">))</span>
    
    </div>
<div class="viewcode-block" id="WlanExpNode.start_network_scan"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.start_network_scan">[docs]</a>    <span class="k">def</span> <span class="nf">start_network_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts the wireless network scan state machine at the node. </span>
<span class="sd">        </span>
<span class="sd">        During a scan, the node cycles through a set of channels and transmits </span>
<span class="sd">        periodic Probe Request frames on each channel.  Information about </span>
<span class="sd">        available wireless networks is extracted from received Probe Responses </span>
<span class="sd">        and Beacon frames. The network scan results can be queried any time </span>
<span class="sd">        using the ``node.get_network_list()`` method.</span>

<span class="sd">        Network scans can only be run by unassociated nodes. An associated </span>
<span class="sd">        node must first reset its BSS state before starting a scan.</span>

<span class="sd">        The network scan state machine can be stopped with </span>
<span class="sd">        ``node.stop_network_scan()``. The scan state machine will also be </span>
<span class="sd">        stopped automatically if the node is configured with a new non-null </span>
<span class="sd">        BSS state.</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">        ::</span>

<span class="sd">            # Ensure node has null BSS state</span>
<span class="sd">            n.configure_bss(None)</span>

<span class="sd">            # Start the scan state machine; scan will use default scan params</span>
<span class="sd">            #  Use n.set_scan_parameters() to customize scan behavior</span>
<span class="sd">            n.start_network_scan()</span>

<span class="sd">            # Wait 5 seconds, retrieve the list of discovered networks</span>
<span class="sd">            time.sleep(5)</span>
<span class="sd">            networks = n.get_network_list()</span>

<span class="sd">            # Stop the scan state machine</span>
<span class="sd">            n.stop_network_scan()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcScan</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    
    </div>
<div class="viewcode-block" id="WlanExpNode.stop_network_scan"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.stop_network_scan">[docs]</a>    <span class="k">def</span> <span class="nf">stop_network_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stops the wireless network scan state machine.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcScan</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="WlanExpNode.is_scanning"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.is_scanning">[docs]</a>    <span class="k">def</span> <span class="nf">is_scanning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Queries if the node&#39;s wireless network scanning state machine is </span>
<span class="sd">        currently running.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            status (bool):</span>

<span class="sd">                * True      -- Scan state machine is running</span>
<span class="sd">                * False     -- Scan state machine is not running</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeProcScan</span><span class="p">())</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Association Commands</span>
    <span class="c">#--------------------------------------------</span></div>
<div class="viewcode-block" id="WlanExpNode.configure_bss"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.configure_bss">[docs]</a>    <span class="k">def</span> <span class="nf">configure_bss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure the Basic Service Set (BSS) information of the node</span>
<span class="sd">        </span>
<span class="sd">        Each node is either a member of no BSS (colloquially &quot;unassociated&quot;) </span>
<span class="sd">        or a member of one BSS.  A node requires a minimum valid bss_info to </span>
<span class="sd">        be a member of a BSS.  Based on the node type, there is a minimum </span>
<span class="sd">        set of fields needed for a valid bss_info.  </span>
<span class="sd">        </span>
<span class="sd">        This method must be overloaded by sub-classes.</span>
<span class="sd">        </span>
<span class="sd">        See http://warpproject.org/trac/wiki/802.11/wlan_exp/bss for more </span>
<span class="sd">        information about BSSes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="WlanExpNode.get_station_info"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_station_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_station_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bss_members</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ret_val</span>
        </div>
    <span class="k">def</span> <span class="nf">get_bss_members</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the BSS members from the node.</span>

<span class="sd">        The StationInfo() returned by this method can be accessed like a </span>
<span class="sd">        dictionary and has the following fields:</span>
<span class="sd">        </span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | Field                       | Description                                                                                        |</span>
<span class="sd">            +=============================+====================================================================================================+</span>
<span class="sd">            | mac_addr                    |  MAC address of station                                                                            |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | id                          |  Identification Index for this station                                                             |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | host_name                   |  String hostname (19 chars max), taken from DHCP DISCOVER packets                                  |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | flags                       |  Station flags.  Value containts 1 bit fields:                                                     |</span>
<span class="sd">            |                             |      * 0x0001 - &#39;KEEP&#39;                                                                             |</span>
<span class="sd">            |                             |      * 0x0002 - &#39;DISABLE_ASSOC_CHECK&#39;                                                              |</span>
<span class="sd">            |                             |      * 0x0004 - &#39;DOZE&#39;                                                                             |</span>
<span class="sd">            |                             |      * 0x0008 - &#39;HT_CAPABLE&#39;                                                                       |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_rx_timestamp         |  Value of System Time in microseconds of last successful Rx from device                            |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_txrx_timestamp       |  Value of System Time in microseconds of last Tx or successful Rx from device                      |            </span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_rx_seq               |  Sequence number of last packet received from device                                               |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_mcs                  |  Current PHY MCS index in [0:7] for new transmissions to device                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_mode                 |  Current PHY mode for new transmissions to deivce                                                  |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_antenna_mode         |  Current PHY antenna mode in [1:4] for new transmissions to device                                 |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_power                |  Current Tx power in dBm for new transmissions to device                                           |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_mac_flags                |  Flags for Tx MAC config for new transmissions to device.  Value contains 1 bit flags:             |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            |                             |      * None defined                                                                                |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            station_infos (list of StationInfo):  </span>
<span class="sd">                List of StationInfo() BSS members known to the node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeGetBSSMembers</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">ret_val</span>


    <span class="k">def</span> <span class="nf">get_station_info_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the all Station Infos from node.</span>

<span class="sd">        The StationInfo() returned by this method can be accessed like a </span>
<span class="sd">        dictionary and has the following fields:</span>
<span class="sd">        </span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | Field                       | Description                                                                                        |</span>
<span class="sd">            +=============================+====================================================================================================+</span>
<span class="sd">            | mac_addr                    |  MAC address of station                                                                            |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | id                          |  Identification Index for this station                                                             |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | host_name                   |  String hostname (19 chars max), taken from DHCP DISCOVER packets                                  |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | flags                       |  Station flags.  Value containts 1 bit fields:                                                     |</span>
<span class="sd">            |                             |      * 0x0001 - &#39;KEEP&#39;                                                                             |</span>
<span class="sd">            |                             |      * 0x0002 - &#39;DISABLE_ASSOC_CHECK&#39;                                                              |</span>
<span class="sd">            |                             |      * 0x0004 - &#39;DOZE&#39;                                                                             |</span>
<span class="sd">            |                             |      * 0x0008 - &#39;HT_CAPABLE&#39;                                                                       |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_rx_timestamp         |  Value of System Time in microseconds of last successful Rx from device                            |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_txrx_timestamp       |  Value of System Time in microseconds of last Tx or successful Rx from device                      |            </span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_rx_seq               |  Sequence number of last packet received from device                                               |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_mcs                  |  Current PHY MCS index in [0:7] for new transmissions to device                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_mode                 |  Current PHY mode for new transmissions to deivce                                                  |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_antenna_mode         |  Current PHY antenna mode in [1:4] for new transmissions to device                                 |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_phy_power                |  Current Tx power in dBm for new transmissions to device                                           |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | tx_mac_flags                |  Flags for Tx MAC config for new transmissions to device.  Value contains 1 bit flags:             |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            |                             |      * None defined                                                                                |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            station_infos (list of StationInfo):  </span>
<span class="sd">                List of all StationInfo() known to the node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeGetStationInfoList</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">ret_val</span>

<div class="viewcode-block" id="WlanExpNode.get_bss_info"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_bss_info">[docs]</a>    <span class="k">def</span> <span class="nf">get_bss_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the node&#39;s BSS info </span>

<span class="sd">        The BSSInfo() returned by this method can be accessed like a </span>
<span class="sd">        dictionary and has the following fields:</span>
<span class="sd">        </span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | Field                       | Description                                                                                        |</span>
<span class="sd">            +=============================+====================================================================================================+</span>
<span class="sd">            | bssid                       |  BSS ID: 48-bit MAC address                                                                        |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | ssid                        |  SSID (32 chars max)                                                                               |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | channel                     |  Primary channel.  In util.wlan_channels = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 36, 40, 44, 48]     |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | channel_type                |  Channel Type.  Value is one of:                                                                   |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            |                             |      * 0x00 - &#39;BW20&#39;                                                                               |</span>
<span class="sd">            |                             |      * 0x01 - &#39;BW40_SEC_BELOW&#39;                                                                     |</span>
<span class="sd">            |                             |      * 0x02 - &#39;BW40_SEC_ABOVE&#39;                                                                     |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_beacon_rx_time       |  Value of System Time in microseconds of last beacon Rx                                            |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | latest_beacon_rx_power      |  Last observed beacon Rx Power (dBm)                                                               |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | capabilities                |  Supported capabilities of the BSS.  Value contains 1 bit fields:                                  |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            |                             |      * 0x0001 - &#39;ESS&#39;                                                                              |</span>
<span class="sd">            |                             |      * 0x0002 - &#39;IBSS&#39;                                                                             |</span>
<span class="sd">            |                             |      * 0x0004 - &#39;HT_CAPABLE&#39;                                                                       |</span>
<span class="sd">            |                             |      * 0x0010 - &#39;PRIVACY&#39;                                                                          |</span>
<span class="sd">            |                             |                                                                                                    |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            | beacon_interval             |  Beacon interval - In time units of 1024 us&#39;                                                       |</span>
<span class="sd">            +-----------------------------+----------------------------------------------------------------------------------------------------+</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            bss_info (BSSInfo):  </span>
<span class="sd">                BSS Info of node (can be None if unassociated)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeGetBSSInfo</span><span class="p">())</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret_val</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">ret_val</span> <span class="o">=</span> <span class="n">ret_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">return</span> <span class="n">ret_val</span>

</div>
<div class="viewcode-block" id="WlanExpNode.get_network_list"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.get_network_list">[docs]</a>    <span class="k">def</span> <span class="nf">get_network_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of known networks (BSSInfo()s) on the node</span>

<span class="sd">        Returns:</span>
<span class="sd">            networks (list of BSSInfo):  </span>
<span class="sd">                List of BSSInfo() that are known to the node </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeGetBSSInfo</span><span class="p">(</span><span class="s">&quot;ALL&quot;</span><span class="p">))</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Queue Commands</span>
    <span class="c">#--------------------------------------------</span></div>
<div class="viewcode-block" id="WlanExpNode.queue_tx_data_purge_all"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.queue_tx_data_purge_all">[docs]</a>    <span class="k">def</span> <span class="nf">queue_tx_data_purge_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Purges all data transmit queues on the node.</span>
<span class="sd">        </span>
<span class="sd">        This will discard all currently enqueued packets awaiting transmission </span>
<span class="sd">        at the time the command is received.  This will not discard packets</span>
<span class="sd">        already submitted to the lower-level MAC for transmission.  Also, this </span>
<span class="sd">        will not stop additional packets from sources such as LTGs from being </span>
<span class="sd">        enqueued.</span>
<span class="sd">        </span>
<span class="sd">        This command is equivalent to ``reset(queue_data=True)``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">QueueTxDataPurgeAll</span><span class="p">())</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Braodcast Commands can be found in util.py</span>
    <span class="c">#--------------------------------------------</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Node User Commands</span>
    <span class="c">#--------------------------------------------</span></div>
<div class="viewcode-block" id="WlanExpNode.send_user_command"><a class="viewcode-back" href="../../node.html#wlan_exp.node.WlanExpNode.send_user_command">[docs]</a>    <span class="k">def</span> <span class="nf">send_user_command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd_id</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send User defined command to the node</span>

<span class="sd">        See documentation on how-to extend wlan_exp:</span>
<span class="sd">        http://warpproject.org/trac/wiki/802.11/wlan_exp/Extending</span>

<span class="sd">        Args:</span>
<span class="sd">            cmd_id (u32):  User-defined Command ID</span>
<span class="sd">            args (u32, list of u32):  Scalar or list of u32 command arguments </span>
<span class="sd">                to send to the node</span>

<span class="sd">        Returns:</span>
<span class="sd">            resp_args (list of u32):  </span>
<span class="sd">                List of u32 response arguments received from the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cmd_id</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Command ID must be defined for a user command&quot;</span><span class="p">)</span>

        <span class="n">ret_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">UserSendCmd</span><span class="p">(</span><span class="n">cmd_id</span><span class="o">=</span><span class="n">cmd_id</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">ret_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ret_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>



    <span class="c">#--------------------------------------------</span>
    <span class="c"># Memory Access Commands - For developer use only</span>
    <span class="c">#--------------------------------------------</span></div>
    <span class="k">def</span> <span class="nf">_mem_write_high</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes &#39;values&#39; to CPU High memory starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):         Address must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            values (list of int):  Each value must be in [0 .. (2^32 - 1)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Convert scalar values to a list for processing</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_mem_access_args</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeMemAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_mem_read_high</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads &#39;length&#39; values from CPU High memory starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):  Address must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            length (int):   Length must be in [1 .. 320] (ie fit in a 1400 byte packet)</span>

<span class="sd">        Returns:</span>
<span class="sd">            values (list of u32):  List of u32 values received from the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_mem_access_args</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeMemAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_mem_write_low</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes &#39;values&#39; to CPU Low memory starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):         Address must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            values (list of int):  Each value must be in [0 .. (2^32 - 1)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Convert scalar values to a list for processing</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_mem_access_args</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeMemAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_mem_read_low</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads &#39;length&#39; values from CPU Low memory starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):  Address must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            length (int):   Length must be in [1 .. 320] (ie fit in a 1400 byte packet)</span>

<span class="sd">        Returns:</span>
<span class="sd">            values (list of u32):  List of u32 values received from the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_mem_access_args</span><span class="p">(</span><span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeMemAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_check_mem_access_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check memory access variables</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):         Address must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            values (list of int):  Each value must be in [0 .. (2^32 - 1)]</span>
<span class="sd">            length (int):          Length must be in [1 .. 320] (ie fit in a 1400 byte packet)</span>

<span class="sd">        Returns:</span>
<span class="sd">            valid (bool):  Are all arguments valid?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">address</span><span class="p">)</span> <span class="o">!=</span> <span class="n">address</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">address</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">address</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: address must be integer value in [0 .. (2^32 - 1)]!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

            <span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(((</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">long</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: values must be scalar or iterable of ints in [0 .. (2^32 - 1)]!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">!=</span> <span class="n">length</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">320</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: length must be an integer [1 .. 320] words (ie, 4 to 1400 bytes)!&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">True</span>


    <span class="k">def</span> <span class="nf">_eeprom_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes &#39;values&#39; to EEPROM starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):         Address must be in [0 .. 15999]</span>
<span class="sd">            values (list of int):  Each value must be in [0 .. 255]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Convert scalar values to a list for processing</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_eeprom_access_args</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))):</span>
            <span class="k">if</span><span class="p">(</span><span class="n">address</span> <span class="o">&gt;=</span> <span class="mi">16000</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: EEPROM addresses [16000 .. 16383] are read only!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeEEPROMAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_WRITE</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_eeprom_read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reads &#39;length&#39; values from EEPROM starting at &#39;address&#39;</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):  Address must be in [0 .. 16383]</span>
<span class="sd">            length (int):   Length must be in [1 .. 320] (ie fit in a 1400 byte packet)</span>

<span class="sd">        Returns:</span>
<span class="sd">            values (list of u8):  List of u8 values received from the node</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_eeprom_access_args</span><span class="p">(</span><span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_cmd</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">NodeEEPROMAccess</span><span class="p">(</span><span class="n">cmd</span><span class="o">=</span><span class="n">cmds</span><span class="o">.</span><span class="n">CMD_PARAM_READ</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">address</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_check_eeprom_access_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check EEPROM access variables</span>

<span class="sd">        Args:</span>
<span class="sd">            address (int):         Address must be in [0 .. 16383]</span>
<span class="sd">            values (list of int):  Each value must be in [0 .. 255]</span>
<span class="sd">            length (int):          Length must be in [1 .. 320] (ie fit in a 1400 byte packet)</span>

<span class="sd">        Returns:</span>
<span class="sd">            valid (bool):  Are all arguments valid?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">address</span><span class="p">)</span> <span class="o">!=</span> <span class="n">address</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">address</span> <span class="o">&gt;=</span> <span class="mi">16384</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">address</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: address must be integer value in [0 .. 16383]!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

            <span class="n">error</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(((</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">long</span><span class="p">))</span> <span class="ow">or</span>
                    <span class="p">(</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="n">error</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: values must be scalar or iterable of ints in [0 .. 255]!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">!=</span> <span class="n">length</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">320</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;ERROR: length must be an integer [1 .. 320] words (ie, 4 to 1400 bytes)!&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">True</span>



    <span class="c">#-------------------------------------------------------------------------</span>
    <span class="c"># Parameter Framework</span>
    <span class="c">#   Allows for processing of hardware parameters</span>
    <span class="c">#-------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">process_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extract values from the parameters&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">identifier</span> <span class="o">==</span> <span class="n">NODE_PARAM_ID_WLAN_EXP_VERSION</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_major</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFF000000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_minor</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x00FF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_revision</span> <span class="o">=</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0000FFFF</span><span class="p">)</span>

                <span class="c"># Check to see if there is a version mismatch</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">check_wlan_exp_ver</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">ParameterError</span><span class="p">(</span><span class="s">&quot;NODE_DESIGN_VER&quot;</span><span class="p">,</span> <span class="s">&quot;Incorrect length&quot;</span><span class="p">)</span>

        <span class="k">elif</span>   <span class="p">(</span><span class="n">identifier</span> <span class="o">==</span> <span class="n">NODE_PARAM_ID_WLAN_MAC_ADDR</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wlan_mac_address</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">+</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">ParameterError</span><span class="p">(</span><span class="s">&quot;NODE_WLAN_MAC_ADDR&quot;</span><span class="p">,</span> <span class="s">&quot;Incorrect length&quot;</span><span class="p">)</span>

        <span class="k">elif</span>   <span class="p">(</span><span class="n">identifier</span> <span class="o">==</span> <span class="n">NODE_PARAM_ID_WLAN_SCHEDULER_RESOLUTION</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scheduler_resolution</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">ParameterError</span><span class="p">(</span><span class="s">&quot;NODE_LTG_RESOLUTION&quot;</span><span class="p">,</span> <span class="s">&quot;Incorrect length&quot;</span><span class="p">)</span>

        <span class="k">elif</span>   <span class="p">(</span><span class="n">identifier</span> <span class="o">==</span> <span class="n">NODE_PARAM_ID_WLAN_MAX_TX_POWER_DBM</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c"># Power is an int transmited as a uint</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">max_tx_power_dbm</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">ParameterError</span><span class="p">(</span><span class="s">&quot;MAX_TX_POWER_DBM&quot;</span><span class="p">,</span> <span class="s">&quot;Incorrect length&quot;</span><span class="p">)</span>

        <span class="k">elif</span>   <span class="p">(</span><span class="n">identifier</span> <span class="o">==</span> <span class="n">NODE_PARAM_ID_WLAN_MIN_TX_POWER_DBM</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c"># Power is an int transmited as a uint</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">min_tx_power_dbm</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span><span class="o">.</span><span class="n">ParameterError</span><span class="p">(</span><span class="s">&quot;MIN_TX_POWER_DBM&quot;</span><span class="p">,</span> <span class="s">&quot;Incorrect length&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">WlanExpNode</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">process_parameter</span><span class="p">(</span><span class="n">identifier</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>


    <span class="c">#-------------------------------------------------------------------------</span>
    <span class="c"># Misc methods for the Node</span>
    <span class="c">#-------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_set_node_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the node_type and keep the device_type in sync.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_type</span>   <span class="o">=</span> <span class="n">node_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_type</span>

    <span class="k">def</span> <span class="nf">_get_node_type_high</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the node type of CPU High</span>

<span class="sd">        See defaults.py for a list of CPU High node types</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_type</span> <span class="o">&amp;</span> <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_HIGH_MASK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_node_type_low</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the node type of CPU Low</span>

<span class="sd">        See defaults.py for a list of CPU Low node types</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_type</span> <span class="o">&amp;</span> <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_MASK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_cpu_high_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">high_type</span><span class="p">,</span> <span class="n">command_name</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the node CPU High type against the high_type argument</span>

<span class="sd">        Args:</span>
<span class="sd">            high_type (int):    Node type for CPU High (see defaults.py)</span>
<span class="sd">            command_name (str): Name of command calling function</span>
<span class="sd">            raise_error (bool): Raise an exception?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_high_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_type_high</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">node_high_type</span> <span class="o">!=</span> <span class="n">high_type</span><span class="p">):</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;WARNING:  CPU High Type mismatch.</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Command </span><span class="se">\&#39;</span><span class="s">{0}()</span><span class="se">\&#39;</span><span class="s"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">command_name</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;expects {0}, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_HIGH_TYPES</span><span class="p">[</span><span class="n">high_type</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;expects UNKNOWN TYPE, &quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;node reports {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_HIGH_TYPES</span><span class="p">[</span><span class="n">node_high_type</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;reports UNKNOWN TYPE</span><span class="se">\n</span><span class="s">&quot;</span>

            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Command may have unintended effects.</span><span class="se">\n</span><span class="s">&quot;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">raise_error</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_cpu_low_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low_type</span><span class="p">,</span> <span class="n">command_name</span><span class="p">,</span> <span class="n">raise_error</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the node CPU Low type against the low_type argument</span>

<span class="sd">        Args:</span>
<span class="sd">            low_type (int):     Node type for CPU Low (see defaults.py)</span>
<span class="sd">            command_name (str): Name of command calling function</span>
<span class="sd">            raise_error (bool): Raise an exception?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node_low_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_type_low</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">node_low_type</span> <span class="o">!=</span> <span class="n">low_type</span><span class="p">):</span>
            <span class="n">msg</span>  <span class="o">=</span> <span class="s">&quot;WARNING:  CPU Low Type mismatch:</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Command </span><span class="se">\&#39;</span><span class="s">{0}</span><span class="se">\&#39;</span><span class="s"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">command_name</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;expects {0}, &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_TYPES</span><span class="p">[</span><span class="n">low_type</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;expects UNKNOWN TYPE, &quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;node reports {0}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_LOW_TYPES</span><span class="p">[</span><span class="n">node_low_type</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;reports UNKNOWN TYPE</span><span class="se">\n</span><span class="s">&quot;</span>

            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&quot;    Command may have unintended effects.</span><span class="se">\n</span><span class="s">&quot;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">raise_error</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_wlan_exp_ver</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check the wlan_exp version of the node against the current wlan_exp </span>
<span class="sd">        version.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ver_str</span>     <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">wlan_exp_ver_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_major</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_minor</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_revision</span><span class="p">)</span>

        <span class="n">caller_desc</span> <span class="o">=</span> <span class="s">&quot;During initialization &#39;{0}&#39; returned version {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="n">ver_str</span><span class="p">)</span>

        <span class="n">status</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">wlan_exp_ver_check</span><span class="p">(</span><span class="n">major</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_major</span><span class="p">,</span>
                                            <span class="n">minor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_minor</span><span class="p">,</span>
                                            <span class="n">revision</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">wlan_exp_ver_revision</span><span class="p">,</span>
                                            <span class="n">caller_desc</span><span class="o">=</span><span class="n">caller_desc</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">version</span><span class="o">.</span><span class="n">WLAN_EXP_VERSION_NEWER</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Please update the C code on the node to the proper wlan_exp version.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">==</span> <span class="n">version</span><span class="o">.</span><span class="n">WLAN_EXP_VERSION_OLDER</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Please update the wlan_exp installation to match the version on the node.&quot;</span><span class="p">)</span>


<span class="c"># End Class WlanExpNode</span>



</div>
<span class="k">class</span> <span class="nc">WlanExpNodeFactory</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">WarpNodeFactory</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sub-class of WarpNodeFactory used to help with node configuration</span>
<span class="sd">    and setup.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_config</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">WlanExpNodeFactory</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">network_config</span><span class="p">)</span>

        <span class="c"># Add default classes to the factory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_DCF_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_DCF_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_DCF_DESCRIPTION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_DCF_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_DCF_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_DCF_DESCRIPTION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_DCF_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_DCF_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_DCF_DESCRIPTION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_NOMAC_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_NOMAC_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_AP_NOMAC_DESCRIPTION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_NOMAC_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_NOMAC_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_STA_NOMAC_DESCRIPTION</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_add_class</span><span class="p">(</span><span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_NOMAC_TYPE</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_NOMAC_CLASS_INST</span><span class="p">,</span>
                            <span class="n">defaults</span><span class="o">.</span><span class="n">WLAN_EXP_IBSS_NOMAC_DESCRIPTION</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">node_eval_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_class</span><span class="p">,</span> <span class="n">network_config</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluate the node_class string to create a node.</span>

<span class="sd">        This should be overridden in each sub-class with the same overall </span>
<span class="sd">        structure but a different import.  Please call the super class so that </span>
<span class="sd">        the calls will propagate to catch all node types.</span>

<span class="sd">        network_config is used as part of the node_class string to initialize </span>
<span class="sd">        the node.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># &quot;import wlan_exp.defaults as defaults&quot; performed at the top of the file</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.node_ap</span> <span class="kn">as</span> <span class="nn">node_ap</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.node_sta</span> <span class="kn">as</span> <span class="nn">node_sta</span>
        <span class="kn">import</span> <span class="nn">wlan_exp.node_ibss</span> <span class="kn">as</span> <span class="nn">node_ibss</span>

        <span class="n">node</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">node_class</span><span class="p">,</span> <span class="nb">globals</span><span class="p">(),</span> <span class="nb">locals</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c"># We will catch all errors that might occur when trying to create</span>
            <span class="c"># the node since this class might not be able to create the node.</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">WlanExpNodeFactory</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">node_eval_class</span><span class="p">(</span><span class="n">node_class</span><span class="p">,</span>
                                                                   <span class="n">network_config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">node</span>


<span class="c"># End Class WlanExpNodeFactory</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Mango Communications, Inc..
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'wlan_exp v1.5.2  ',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>